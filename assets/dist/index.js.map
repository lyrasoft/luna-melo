{"version":3,"file":"index.js","sources":["../src/features/lesson/useLessonCartButtons.ts","../src/features/section/useSectionEditComponents.ts","../src/features/question/useQuestionEditComponents.ts","../src/index.ts"],"sourcesContent":["import { delegate, route, simpleAlert, useHttpClient } from '@windwalker-io/unicorn-next';\r\n\r\nexport function useLessonCartButtons() {\r\n  function listen(selector = '[data-task=buy]') {\r\n    delegate(document.body, selector, 'click', (e) => {\r\n      buy(e.currentTarget as HTMLElement);\r\n    });\r\n  }\r\n\r\n  async function sendAddAction(el: HTMLElement) {\r\n    const lessonId = el.dataset.id;\r\n\r\n    if (!lessonId) {\r\n      throw new Error('No lesson ID');\r\n    }\r\n\r\n    const { post } = await useHttpClient();\r\n\r\n    try {\r\n      const res = await post(\r\n        '@melo_cart_ajax/addToCart',\r\n        {\r\n          id: lessonId,\r\n        }\r\n      );\r\n\r\n      return res.data;\r\n    } catch (e) {\r\n      console.error(e);\r\n      throw e;\r\n    }\r\n  }\r\n\r\n  async function buy(el: HTMLElement) {\r\n    const { isAxiosError } = await useHttpClient();\r\n\r\n    try {\r\n      await sendAddAction(el);\r\n    } catch (e) {\r\n      if (isAxiosError(e)) {\r\n        simpleAlert(e.message, '', 'warning');\r\n      }\r\n      return;\r\n    }\r\n\r\n    toCartPage();\r\n  }\r\n\r\n  function toCartPage() {\r\n    location.href = route('melo_cart');\r\n  }\r\n\r\n  return {\r\n    listen,\r\n    buy,\r\n    toCartPage,\r\n    sendAddAction,\r\n  };\r\n}\r\n","\r\ntype ModuleImportCallback = () => Promise<any>;\r\n\r\nconst sectionEditComponents: Record<string, ModuleImportCallback> = {\r\n  video: () => import('~melo/components/segment-edit/section/SectionVideoEdit.vue'),\r\n  homework: () => import('~melo/components/segment-edit/section/SectionHomeworkEdit.vue'),\r\n  quiz: () => import('~melo/components/segment-edit/section/SectionQuizEdit.vue'),\r\n}\r\n\r\nexport function useSectionEditComponents(): Record<string, ModuleImportCallback>;\r\nexport function useSectionEditComponents(id: string, component: ModuleImportCallback): Record<string, ModuleImportCallback>;\r\nexport function useSectionEditComponents(id: Record<string, ModuleImportCallback>): Record<string, ModuleImportCallback>;\r\nexport function useSectionEditComponents(id?: string | Record<string, ModuleImportCallback>, component?: ModuleImportCallback) {\r\n  if (typeof id === 'object') {\r\n    Object.assign(sectionEditComponents, id);\r\n  } else if (component && typeof id === 'string') {\r\n    sectionEditComponents[id] = component;\r\n  }\r\n\r\n  return sectionEditComponents;\r\n}\r\n\r\n","\r\ntype ModuleImportCallback = () => Promise<any>;\r\n\r\nconst questionEditComponents: Record<string, ModuleImportCallback> = {\r\n  boolean: () => import('~melo/components/segment-edit/question/QuestionEdit.vue'),\r\n  select: () => import('~melo/components/segment-edit/question/QuestionEdit.vue'),\r\n  multiple: () => import('~melo/components/segment-edit/question/QuestionEdit.vue'),\r\n}\r\n\r\nexport function useQuestionEditComponents(): Record<string, ModuleImportCallback>;\r\nexport function useQuestionEditComponents(id: string, component: ModuleImportCallback): Record<string, ModuleImportCallback>;\r\nexport function useQuestionEditComponents(id: Record<string, ModuleImportCallback>): Record<string, ModuleImportCallback>;\r\nexport function useQuestionEditComponents(id?: string | Record<string, ModuleImportCallback>, component?: ModuleImportCallback) {\r\n  if (typeof id === 'object') {\r\n    Object.assign(questionEditComponents, id);\r\n  } else if (component && typeof id === 'string') {\r\n    questionEditComponents[id] = component;\r\n  }\r\n\r\n  return questionEditComponents;\r\n}\r\n\r\n","\r\nexport * from '~melo/features/lesson/useLessonCartButtons';\r\nexport * from '~melo/features/section/useSectionEditComponents';\r\nexport * from '~melo/features/question/useQuestionEditComponents';\r\nexport * from '~melo/types';\r\n\r\nexport async function createSegmentEditorApp(props: Record<string, any>) {\r\n  const { createSegmentEditorApp } = await import('~melo/segment-editor');\r\n\r\n  return createSegmentEditorApp(props);\r\n}\r\n\r\nexport async function createMeloCartApp(props: Record<string, any>) {\r\n  const { createMeloCartApp } = await import('~melo/melo-cart');\r\n\r\n  return createMeloCartApp(props);\r\n}\r\n"],"names":["createSegmentEditorApp","createMeloCartApp"],"mappings":";AAEO,SAAS,uBAAuB;AACrC,WAAS,OAAO,WAAW,mBAAmB;AAC5C,aAAS,SAAS,MAAM,UAAU,SAAS,CAAC,MAAM;AAChD,UAAI,EAAE,aAA4B;AAAA,IACpC,CAAC;AAAA,EACH;AAEA,iBAAe,cAAc,IAAiB;AAC5C,UAAM,WAAW,GAAG,QAAQ;AAE5B,QAAI,CAAC,UAAU;AACb,YAAM,IAAI,MAAM,cAAc;AAAA,IAChC;AAEA,UAAM,EAAE,SAAS,MAAM,cAAA;AAEvB,QAAI;AACF,YAAM,MAAM,MAAM;AAAA,QAChB;AAAA,QACA;AAAA,UACE,IAAI;AAAA,QAAA;AAAA,MACN;AAGF,aAAO,IAAI;AAAA,IACb,SAAS,GAAG;AACV,cAAQ,MAAM,CAAC;AACf,YAAM;AAAA,IACR;AAAA,EACF;AAEA,iBAAe,IAAI,IAAiB;AAClC,UAAM,EAAE,iBAAiB,MAAM,cAAA;AAE/B,QAAI;AACF,YAAM,cAAc,EAAE;AAAA,IACxB,SAAS,GAAG;AACV,UAAI,aAAa,CAAC,GAAG;AACnB,oBAAY,EAAE,SAAS,IAAI,SAAS;AAAA,MACtC;AACA;AAAA,IACF;AAEA,eAAA;AAAA,EACF;AAEA,WAAS,aAAa;AACpB,aAAS,OAAO,MAAM,WAAW;AAAA,EACnC;AAEA,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EAAA;AAEJ;ACvDA,MAAM,wBAA8D;AAAA,EAClE,OAAO,MAAM,OAAO,8BAA4D;AAAA,EAChF,UAAU,MAAM,OAAO,iCAA+D;AAAA,EACtF,MAAM,MAAM,OAAO,6BAA2D;AAChF;AAKO,SAAS,yBAAyB,IAAoD,WAAkC;AAC7H,MAAI,OAAO,OAAO,UAAU;AAC1B,WAAO,OAAO,uBAAuB,EAAE;AAAA,EACzC,WAAW,aAAa,OAAO,OAAO,UAAU;AAC9C,0BAAsB,EAAE,IAAI;AAAA,EAC9B;AAEA,SAAO;AACT;ACjBA,MAAM,yBAA+D;AAAA,EACnE,SAAS,MAAM,OAAO,0BAAyD,EAAA,KAAA,OAAA,EAAA,CAAA;AAAA,EAC/E,QAAQ,MAAM,OAAO,0BAAyD,EAAA,KAAA,OAAA,EAAA,CAAA;AAAA,EAC9E,UAAU,MAAM,OAAO,0BAAyD,EAAA,KAAA,OAAA,EAAA,CAAA;AAClF;AAKO,SAAS,0BAA0B,IAAoD,WAAkC;AAC9H,MAAI,OAAO,OAAO,UAAU;AAC1B,WAAO,OAAO,wBAAwB,EAAE;AAAA,EAC1C,WAAW,aAAa,OAAO,OAAO,UAAU;AAC9C,2BAAuB,EAAE,IAAI;AAAA,EAC/B;AAEA,SAAO;AACT;ACdA,eAAsB,uBAAuB,OAA4B;AACvE,QAAM,EAAE,wBAAAA,4BAA2B,MAAM,OAAO,4BAAsB;AAEtE,SAAOA,wBAAuB,KAAK;AACrC;AAEA,eAAsB,kBAAkB,OAA4B;AAClE,QAAM,EAAE,mBAAAC,uBAAsB,MAAM,OAAO,uBAAiB;AAE5D,SAAOA,mBAAkB,KAAK;AAChC;"}