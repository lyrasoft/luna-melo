/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk_vue_entries_admin_segment_edit_ts"] = self["webpackChunk_vue_entries_admin_segment_edit_ts"] || []).push([["vendors-node_modules_js-video-url-parser_dist_jsVideoUrlParser_js"],{

/***/ "../../../../node_modules/js-video-url-parser/dist/jsVideoUrlParser.js":
/*!*****************************************************************************!*\
  !*** ../../../../node_modules/js-video-url-parser/dist/jsVideoUrlParser.js ***!
  \*****************************************************************************/
/***/ (function(module) {

eval("(function (global, factory) {\n   true ? module.exports = factory() :\n  0;\n}(this, (function () { 'use strict';\n\n  function _typeof(obj) {\n    \"@babel/helpers - typeof\";\n\n    if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n      _typeof = function (obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function (obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  var getQueryParams = function getQueryParams(qs) {\n    if (typeof qs !== 'string') {\n      return {};\n    }\n\n    qs = qs.split('+').join(' ');\n    var params = {};\n    var match = qs.match(/(?:[?](?:[^=]+)=(?:[^&#]*)(?:[&](?:[^=]+)=(?:[^&#]*))*(?:[#].*)?)|(?:[#].*)/);\n    var split;\n\n    if (match === null) {\n      return {};\n    }\n\n    split = match[0].substr(1).split(/[&#=]/);\n\n    for (var i = 0; i < split.length; i += 2) {\n      params[decodeURIComponent(split[i])] = decodeURIComponent(split[i + 1] || '');\n    }\n\n    return params;\n  };\n\n  var combineParams = function combineParams(params, hasParams) {\n    if (_typeof(params) !== 'object') {\n      return '';\n    }\n\n    var combined = '';\n    var i = 0;\n    var keys = Object.keys(params);\n\n    if (keys.length === 0) {\n      return '';\n    } //always have parameters in the same order\n\n\n    keys.sort();\n\n    if (!hasParams) {\n      combined += '?' + keys[0] + '=' + params[keys[0]];\n      i += 1;\n    }\n\n    for (; i < keys.length; i += 1) {\n      combined += '&' + keys[i] + '=' + params[keys[i]];\n    }\n\n    return combined;\n  }; //parses strings like 1h30m20s to seconds\n\n\n  function getLetterTime(timeString) {\n    var totalSeconds = 0;\n    var timeValues = {\n      's': 1,\n      'm': 1 * 60,\n      'h': 1 * 60 * 60,\n      'd': 1 * 60 * 60 * 24,\n      'w': 1 * 60 * 60 * 24 * 7\n    };\n    var timePairs; //expand to \"1 h 30 m 20 s\" and split\n\n    timeString = timeString.replace(/([smhdw])/g, ' $1 ').trim();\n    timePairs = timeString.split(' ');\n\n    for (var i = 0; i < timePairs.length; i += 2) {\n      totalSeconds += parseInt(timePairs[i], 10) * timeValues[timePairs[i + 1] || 's'];\n    }\n\n    return totalSeconds;\n  } //parses strings like 1:30:20 to seconds\n\n\n  function getColonTime(timeString) {\n    var totalSeconds = 0;\n    var timeValues = [1, 1 * 60, 1 * 60 * 60, 1 * 60 * 60 * 24, 1 * 60 * 60 * 24 * 7];\n    var timePairs = timeString.split(':');\n\n    for (var i = 0; i < timePairs.length; i++) {\n      totalSeconds += parseInt(timePairs[i], 10) * timeValues[timePairs.length - i - 1];\n    }\n\n    return totalSeconds;\n  }\n\n  var getTime = function getTime(timeString) {\n    if (typeof timeString === 'undefined') {\n      return 0;\n    }\n\n    if (timeString.match(/^(\\d+[smhdw]?)+$/)) {\n      return getLetterTime(timeString);\n    }\n\n    if (timeString.match(/^(\\d+:?)+$/)) {\n      return getColonTime(timeString);\n    }\n\n    return 0;\n  };\n\n  var util = {\n    getQueryParams: getQueryParams,\n    combineParams: combineParams,\n    getTime: getTime\n  };\n\n  var getQueryParams$1 = util.getQueryParams;\n\n  function UrlParser() {\n    for (var _i = 0, _arr = ['parseProvider', 'parse', 'bind', 'create']; _i < _arr.length; _i++) {\n      var key = _arr[_i];\n      this[key] = this[key].bind(this);\n    }\n\n    this.plugins = {};\n  }\n\n  var urlParser = UrlParser;\n\n  UrlParser.prototype.parseProvider = function (url) {\n    var match = url.match(/(?:(?:https?:)?\\/\\/)?(?:[^.]+\\.)?(\\w+)\\./i);\n    return match ? match[1] : undefined;\n  };\n\n  UrlParser.prototype.parse = function (url) {\n    if (typeof url === 'undefined') {\n      return undefined;\n    }\n\n    var provider = this.parseProvider(url);\n    var result;\n    var plugin = this.plugins[provider];\n\n    if (!provider || !plugin || !plugin.parse) {\n      return undefined;\n    }\n\n    result = plugin.parse.call(plugin, url, getQueryParams$1(url));\n\n    if (result) {\n      result = removeEmptyParameters(result);\n      result.provider = plugin.provider;\n    }\n\n    return result;\n  };\n\n  UrlParser.prototype.bind = function (plugin) {\n    this.plugins[plugin.provider] = plugin;\n\n    if (plugin.alternatives) {\n      for (var i = 0; i < plugin.alternatives.length; i += 1) {\n        this.plugins[plugin.alternatives[i]] = plugin;\n      }\n    }\n  };\n\n  UrlParser.prototype.create = function (op) {\n    if (_typeof(op) !== 'object' || _typeof(op.videoInfo) !== 'object') {\n      return undefined;\n    }\n\n    var vi = op.videoInfo;\n    var params = op.params;\n    var plugin = this.plugins[vi.provider];\n    params = params === 'internal' ? vi.params : params || {};\n\n    if (plugin) {\n      op.format = op.format || plugin.defaultFormat; // eslint-disable-next-line no-prototype-builtins\n\n      if (plugin.formats.hasOwnProperty(op.format)) {\n        return plugin.formats[op.format].apply(plugin, [vi, Object.assign({}, params)]);\n      }\n    }\n\n    return undefined;\n  };\n\n  function removeEmptyParameters(result) {\n    if (result.params && Object.keys(result.params).length === 0) {\n      delete result.params;\n    }\n\n    return result;\n  }\n\n  var parser = new urlParser();\n  var base = parser;\n\n  function Allocine() {\n    this.provider = 'allocine';\n    this.alternatives = [];\n    this.defaultFormat = 'embed';\n    this.formats = {\n      embed: this.createEmbedUrl\n    };\n    this.mediaTypes = {\n      VIDEO: 'video'\n    };\n  }\n\n  Allocine.prototype.parseUrl = function (url) {\n    var match = url.match(/(?:\\/video\\/player_gen_cmedia=)([A-Za-z0-9]+)/i);\n    return match ? match[1] : undefined;\n  };\n\n  Allocine.prototype.parse = function (url) {\n    var result = {\n      mediaType: this.mediaTypes.VIDEO,\n      id: this.parseUrl(url)\n    };\n    return result.id ? result : undefined;\n  };\n\n  Allocine.prototype.createEmbedUrl = function (vi) {\n    if (!vi.id || vi.mediaType !== this.mediaTypes.VIDEO) {\n      return undefined;\n    }\n\n    return 'https://player.allocine.fr/' + vi.id + '.html';\n  };\n\n  base.bind(new Allocine());\n\n  var combineParams$1 = util.combineParams;\n\n  function CanalPlus() {\n    this.provider = 'canalplus';\n    this.defaultFormat = 'embed';\n    this.formats = {\n      embed: this.createEmbedUrl\n    };\n    this.mediaTypes = {\n      VIDEO: 'video'\n    };\n  }\n\n  CanalPlus.prototype.parseParameters = function (params) {\n    delete params.vid;\n    return params;\n  };\n\n  CanalPlus.prototype.parse = function (url, params) {\n    var _this = this;\n\n    var result = {\n      mediaType: this.mediaTypes.VIDEO,\n      id: params.vid\n    };\n    result.params = _this.parseParameters(params);\n\n    if (!result.id) {\n      return undefined;\n    }\n\n    return result;\n  };\n\n  CanalPlus.prototype.createEmbedUrl = function (vi, params) {\n    if (!vi.id || vi.mediaType !== this.mediaTypes.VIDEO) {\n      return undefined;\n    }\n\n    var url = 'http://player.canalplus.fr/embed/';\n    params.vid = vi.id;\n    url += combineParams$1(params);\n    return url;\n  };\n\n  base.bind(new CanalPlus());\n\n  var combineParams$2 = util.combineParams;\n\n  function Coub() {\n    this.provider = 'coub';\n    this.defaultFormat = 'long';\n    this.formats = {\n      \"long\": this.createLongUrl,\n      embed: this.createEmbedUrl\n    };\n    this.mediaTypes = {\n      VIDEO: 'video'\n    };\n  }\n\n  Coub.prototype.parseUrl = function (url) {\n    var match = url.match(/(?:embed|view)\\/([a-zA-Z\\d]+)/i);\n    return match ? match[1] : undefined;\n  };\n\n  Coub.prototype.parse = function (url, params) {\n    var result = {\n      mediaType: this.mediaTypes.VIDEO,\n      params: params,\n      id: this.parseUrl(url)\n    };\n\n    if (!result.id) {\n      return undefined;\n    }\n\n    return result;\n  };\n\n  Coub.prototype.createUrl = function (baseUrl, vi, params) {\n    if (!vi.id || vi.mediaType !== this.mediaTypes.VIDEO) {\n      return undefined;\n    }\n\n    var url = baseUrl + vi.id;\n    url += combineParams$2(params);\n    return url;\n  };\n\n  Coub.prototype.createLongUrl = function (vi, params) {\n    return this.createUrl('https://coub.com/view/', vi, params);\n  };\n\n  Coub.prototype.createEmbedUrl = function (vi, params) {\n    return this.createUrl('//coub.com/embed/', vi, params);\n  };\n\n  base.bind(new Coub());\n\n  var combineParams$3 = util.combineParams,\n      getTime$1 = util.getTime;\n\n  function Dailymotion() {\n    this.provider = 'dailymotion';\n    this.alternatives = ['dai'];\n    this.defaultFormat = 'long';\n    this.formats = {\n      \"short\": this.createShortUrl,\n      \"long\": this.createLongUrl,\n      embed: this.createEmbedUrl,\n      image: this.createImageUrl\n    };\n    this.mediaTypes = {\n      VIDEO: 'video'\n    };\n  }\n\n  Dailymotion.prototype.parseParameters = function (params) {\n    return this.parseTime(params);\n  };\n\n  Dailymotion.prototype.parseTime = function (params) {\n    if (params.start) {\n      params.start = getTime$1(params.start);\n    }\n\n    return params;\n  };\n\n  Dailymotion.prototype.parseUrl = function (url) {\n    var match = url.match(/(?:\\/video|ly)\\/([A-Za-z0-9]+)/i);\n    return match ? match[1] : undefined;\n  };\n\n  Dailymotion.prototype.parse = function (url, params) {\n    var _this = this;\n\n    var result = {\n      mediaType: this.mediaTypes.VIDEO,\n      params: _this.parseParameters(params),\n      id: _this.parseUrl(url)\n    };\n    return result.id ? result : undefined;\n  };\n\n  Dailymotion.prototype.createUrl = function (base, vi, params) {\n    if (!vi.id || vi.mediaType !== this.mediaTypes.VIDEO) {\n      return undefined;\n    }\n\n    return base + vi.id + combineParams$3(params);\n  };\n\n  Dailymotion.prototype.createShortUrl = function (vi, params) {\n    return this.createUrl('https://dai.ly/', vi, params);\n  };\n\n  Dailymotion.prototype.createLongUrl = function (vi, params) {\n    return this.createUrl('https://dailymotion.com/video/', vi, params);\n  };\n\n  Dailymotion.prototype.createEmbedUrl = function (vi, params) {\n    return this.createUrl('https://www.dailymotion.com/embed/video/', vi, params);\n  };\n\n  Dailymotion.prototype.createImageUrl = function (vi, params) {\n    delete params.start;\n    return this.createUrl('https://www.dailymotion.com/thumbnail/video/', vi, params);\n  };\n\n  base.bind(new Dailymotion());\n\n  var combineParams$4 = util.combineParams;\n\n  function Loom() {\n    this.provider = 'loom';\n    this.defaultFormat = 'long';\n    this.formats = {\n      \"long\": this.createLongUrl,\n      embed: this.createEmbedUrl\n    };\n    this.mediaTypes = {\n      VIDEO: 'video'\n    };\n  }\n\n  Loom.prototype.parseUrl = function (url) {\n    var match = url.match(/(?:share|embed)\\/([a-zA-Z\\d]+)/i);\n    return match ? match[1] : undefined;\n  };\n\n  Loom.prototype.parse = function (url, params) {\n    var result = {\n      mediaType: this.mediaTypes.VIDEO,\n      params: params,\n      id: this.parseUrl(url)\n    };\n    return result.id ? result : undefined;\n  };\n\n  Loom.prototype.createUrl = function (baseUrl, vi, params) {\n    if (!vi.id || vi.mediaType !== this.mediaTypes.VIDEO) {\n      return undefined;\n    }\n\n    var url = baseUrl + vi.id;\n    url += combineParams$4(params);\n    return url;\n  };\n\n  Loom.prototype.createLongUrl = function (vi, params) {\n    return this.createUrl('https://loom.com/share/', vi, params);\n  };\n\n  Loom.prototype.createEmbedUrl = function (vi, params) {\n    return this.createUrl('//loom.com/embed/', vi, params);\n  };\n\n  base.bind(new Loom());\n\n  var combineParams$5 = util.combineParams,\n      getTime$2 = util.getTime;\n\n  function Twitch() {\n    this.provider = 'twitch';\n    this.defaultFormat = 'long';\n    this.formats = {\n      \"long\": this.createLongUrl,\n      embed: this.createEmbedUrl\n    };\n    this.mediaTypes = {\n      VIDEO: 'video',\n      STREAM: 'stream',\n      CLIP: 'clip'\n    };\n  }\n\n  Twitch.prototype.seperateId = function (id) {\n    return {\n      pre: id[0],\n      id: id.substr(1)\n    };\n  };\n\n  Twitch.prototype.parseChannel = function (result, params) {\n    var channel = params.channel || params.utm_content || result.channel;\n    delete params.utm_content;\n    delete params.channel;\n    return channel;\n  };\n\n  Twitch.prototype.parseUrl = function (url, result, params) {\n    var match;\n    match = url.match(/(clips\\.)?twitch\\.tv\\/(?:(?:videos\\/(\\d+))|(\\w+(?:-[\\w\\d-]+)?)(?:\\/clip\\/(\\w+))?)/i);\n\n    if (match && match[2]) {\n      //video\n      result.id = 'v' + match[2];\n    } else if (params.video) {\n      //video embed\n      result.id = params.video;\n      delete params.video;\n    } else if (params.clip) {\n      //clips embed\n      result.id = params.clip;\n      result.isClip = true;\n      delete params.clip;\n    } else if (match && match[1] && match[3]) {\n      //clips.twitch.tv/id\n      result.id = match[3];\n      result.isClip = true;\n    } else if (match && match[3] && match[4]) {\n      //twitch.tv/channel/clip/id\n      result.channel = match[3];\n      result.id = match[4];\n      result.isClip = true;\n    } else if (match && match[3]) {\n      result.channel = match[3];\n    }\n\n    return result;\n  };\n\n  Twitch.prototype.parseMediaType = function (result) {\n    var mediaType;\n\n    if (result.id) {\n      if (result.isClip) {\n        mediaType = this.mediaTypes.CLIP;\n        delete result.isClip;\n      } else {\n        mediaType = this.mediaTypes.VIDEO;\n      }\n    } else if (result.channel) {\n      mediaType = this.mediaTypes.STREAM;\n    }\n\n    return mediaType;\n  };\n\n  Twitch.prototype.parseParameters = function (params) {\n    if (params.t) {\n      params.start = getTime$2(params.t);\n      delete params.t;\n    }\n\n    return params;\n  };\n\n  Twitch.prototype.parse = function (url, params) {\n    var _this = this;\n\n    var result = {};\n    result = _this.parseUrl(url, result, params);\n    result.channel = _this.parseChannel(result, params);\n    result.mediaType = _this.parseMediaType(result);\n    result.params = _this.parseParameters(params);\n    return result.channel || result.id ? result : undefined;\n  };\n\n  Twitch.prototype.createLongUrl = function (vi, params) {\n    var url = '';\n\n    if (vi.mediaType === this.mediaTypes.STREAM && vi.channel) {\n      url = 'https://twitch.tv/' + vi.channel;\n    } else if (vi.mediaType === this.mediaTypes.VIDEO && vi.id) {\n      var sep = this.seperateId(vi.id);\n      url = 'https://twitch.tv/videos/' + sep.id;\n\n      if (params.start) {\n        params.t = params.start + 's';\n        delete params.start;\n      }\n    } else if (vi.mediaType === this.mediaTypes.CLIP && vi.id) {\n      if (vi.channel) {\n        url = 'https://www.twitch.tv/' + vi.channel + '/clip/' + vi.id;\n      } else {\n        url = 'https://clips.twitch.tv/' + vi.id;\n      }\n    } else {\n      return undefined;\n    }\n\n    url += combineParams$5(params);\n    return url;\n  };\n\n  Twitch.prototype.createEmbedUrl = function (vi, params) {\n    var url = 'https://player.twitch.tv/';\n\n    if (vi.mediaType === this.mediaTypes.STREAM && vi.channel) {\n      params.channel = vi.channel;\n    } else if (vi.mediaType === this.mediaTypes.VIDEO && vi.id) {\n      params.video = vi.id;\n\n      if (params.start) {\n        params.t = params.start + 's';\n        delete params.start;\n      }\n    } else if (vi.mediaType === this.mediaTypes.CLIP && vi.id) {\n      url = 'https://clips.twitch.tv/embed';\n      params.clip = vi.id;\n    } else {\n      return undefined;\n    }\n\n    url += combineParams$5(params);\n    return url;\n  };\n\n  base.bind(new Twitch());\n\n  var combineParams$6 = util.combineParams,\n      getTime$3 = util.getTime;\n\n  function Vimeo() {\n    this.provider = 'vimeo';\n    this.alternatives = ['vimeopro'];\n    this.defaultFormat = 'long';\n    this.formats = {\n      \"long\": this.createLongUrl,\n      embed: this.createEmbedUrl\n    };\n    this.mediaTypes = {\n      VIDEO: 'video'\n    };\n  }\n\n  Vimeo.prototype.parseUrl = function (url) {\n    var match = url.match(/(?:\\/showcase\\/\\d+)?(?:\\/(?:channels\\/[\\w]+|(?:(?:album\\/\\d+|groups\\/[\\w]+)\\/)?videos?))?\\/(\\d+)/i);\n    return match ? match[1] : undefined;\n  };\n\n  Vimeo.prototype.parseHash = function (url) {\n    var match = url.match(/\\/\\d+\\/(\\w+)$/i);\n    return match ? match[1] : undefined;\n  };\n\n  Vimeo.prototype.parseParameters = function (params) {\n    if (params.t) {\n      params.start = getTime$3(params.t);\n      delete params.t;\n    }\n\n    if (params.h) {\n      params.hash = params.h;\n      delete params.h;\n    }\n\n    return params;\n  };\n\n  Vimeo.prototype.parse = function (url, params) {\n    var result = {\n      mediaType: this.mediaTypes.VIDEO,\n      params: this.parseParameters(params),\n      id: this.parseUrl(url)\n    };\n    var hash = this.parseHash(url, params);\n\n    if (hash) {\n      result.params.hash = hash;\n    }\n\n    return result.id ? result : undefined;\n  };\n\n  Vimeo.prototype.createUrl = function (baseUrl, vi, params, type) {\n    if (!vi.id || vi.mediaType !== this.mediaTypes.VIDEO) {\n      return undefined;\n    }\n\n    var url = baseUrl + vi.id;\n    var startTime = params.start;\n    delete params.start;\n\n    if (params.hash) {\n      if (type === 'embed') {\n        params.h = params.hash;\n      } else if (type === 'long') {\n        url += '/' + params.hash;\n      }\n\n      delete params.hash;\n    }\n\n    url += combineParams$6(params);\n\n    if (startTime) {\n      url += '#t=' + startTime;\n    }\n\n    return url;\n  };\n\n  Vimeo.prototype.createLongUrl = function (vi, params) {\n    return this.createUrl('https://vimeo.com/', vi, params, 'long');\n  };\n\n  Vimeo.prototype.createEmbedUrl = function (vi, params) {\n    return this.createUrl('//player.vimeo.com/video/', vi, params, 'embed');\n  };\n\n  base.bind(new Vimeo());\n\n  var combineParams$7 = util.combineParams,\n      getTime$4 = util.getTime;\n\n  function Wistia() {\n    this.provider = 'wistia';\n    this.alternatives = [];\n    this.defaultFormat = 'long';\n    this.formats = {\n      \"long\": this.createLongUrl,\n      embed: this.createEmbedUrl,\n      embedjsonp: this.createEmbedJsonpUrl\n    };\n    this.mediaTypes = {\n      VIDEO: 'video',\n      EMBEDVIDEO: 'embedvideo'\n    };\n  }\n\n  Wistia.prototype.parseUrl = function (url) {\n    var match = url.match(/(?:(?:medias|iframe)\\/|wvideo=)([\\w-]+)/);\n    return match ? match[1] : undefined;\n  };\n\n  Wistia.prototype.parseChannel = function (url) {\n    var match = url.match(/(?:(?:https?:)?\\/\\/)?([^.]*)\\.wistia\\./);\n    var channel = match ? match[1] : undefined;\n\n    if (channel === 'fast' || channel === 'content') {\n      return undefined;\n    }\n\n    return channel;\n  };\n\n  Wistia.prototype.parseParameters = function (params, result) {\n    if (params.wtime) {\n      params.start = getTime$4(params.wtime);\n      delete params.wtime;\n    }\n\n    if (params.wvideo === result.id) {\n      delete params.wvideo;\n    }\n\n    return params;\n  };\n\n  Wistia.prototype.parseMediaType = function (result) {\n    if (result.id && result.channel) {\n      return this.mediaTypes.VIDEO;\n    } else if (result.id) {\n      delete result.channel;\n      return this.mediaTypes.EMBEDVIDEO;\n    } else {\n      return undefined;\n    }\n  };\n\n  Wistia.prototype.parse = function (url, params) {\n    var result = {\n      id: this.parseUrl(url),\n      channel: this.parseChannel(url)\n    };\n    result.params = this.parseParameters(params, result);\n    result.mediaType = this.parseMediaType(result);\n\n    if (!result.id) {\n      return undefined;\n    }\n\n    return result;\n  };\n\n  Wistia.prototype.createUrl = function (vi, params, url) {\n    if (params.start) {\n      params.wtime = params.start;\n      delete params.start;\n    }\n\n    url += combineParams$7(params);\n    return url;\n  };\n\n  Wistia.prototype.createLongUrl = function (vi, params) {\n    if (!vi.id || vi.mediaType !== this.mediaTypes.VIDEO) {\n      return undefined;\n    }\n\n    var url = 'https://' + vi.channel + '.wistia.com/medias/' + vi.id;\n    return this.createUrl(vi, params, url);\n  };\n\n  Wistia.prototype.createEmbedUrl = function (vi, params) {\n    if (!vi.id || !(vi.mediaType === this.mediaTypes.VIDEO || vi.mediaType === this.mediaTypes.EMBEDVIDEO)) {\n      return undefined;\n    }\n\n    var url = 'https://fast.wistia.com/embed/iframe/' + vi.id;\n    return this.createUrl(vi, params, url);\n  };\n\n  Wistia.prototype.createEmbedJsonpUrl = function (vi) {\n    if (!vi.id || !(vi.mediaType === this.mediaTypes.VIDEO || vi.mediaType === this.mediaTypes.EMBEDVIDEO)) {\n      return undefined;\n    }\n\n    return 'https://fast.wistia.com/embed/medias/' + vi.id + '.jsonp';\n  };\n\n  base.bind(new Wistia());\n\n  var combineParams$8 = util.combineParams;\n\n  function Youku() {\n    this.provider = 'youku';\n    this.defaultFormat = 'long';\n    this.formats = {\n      embed: this.createEmbedUrl,\n      \"long\": this.createLongUrl,\n      flash: this.createFlashUrl,\n      \"static\": this.createStaticUrl\n    };\n    this.mediaTypes = {\n      VIDEO: 'video'\n    };\n  }\n\n  Youku.prototype.parseUrl = function (url) {\n    var match = url.match(/(?:(?:embed|sid)\\/|v_show\\/id_|VideoIDS=)([a-zA-Z0-9]+)/);\n    return match ? match[1] : undefined;\n  };\n\n  Youku.prototype.parseParameters = function (params) {\n    if (params.VideoIDS) {\n      delete params.VideoIDS;\n    }\n\n    return params;\n  };\n\n  Youku.prototype.parse = function (url, params) {\n    var _this = this;\n\n    var result = {\n      mediaType: this.mediaTypes.VIDEO,\n      id: _this.parseUrl(url),\n      params: _this.parseParameters(params)\n    };\n\n    if (!result.id) {\n      return undefined;\n    }\n\n    return result;\n  };\n\n  Youku.prototype.createUrl = function (baseUrl, vi, params) {\n    if (!vi.id || vi.mediaType !== this.mediaTypes.VIDEO) {\n      return undefined;\n    }\n\n    var url = baseUrl + vi.id;\n    url += combineParams$8(params);\n    return url;\n  };\n\n  Youku.prototype.createEmbedUrl = function (vi, params) {\n    return this.createUrl('http://player.youku.com/embed/', vi, params);\n  };\n\n  Youku.prototype.createLongUrl = function (vi, params) {\n    return this.createUrl('http://v.youku.com/v_show/id_', vi, params);\n  };\n\n  Youku.prototype.createStaticUrl = function (vi, params) {\n    return this.createUrl('http://static.youku.com/v1.0.0638/v/swf/loader.swf?VideoIDS=', vi, params);\n  };\n\n  Youku.prototype.createFlashUrl = function (vi, params) {\n    if (!vi.id || vi.mediaType !== this.mediaTypes.VIDEO) {\n      return undefined;\n    }\n\n    var url = 'http://player.youku.com/player.php/sid/' + vi.id + '/v.swf';\n    url += combineParams$8(params);\n    return url;\n  };\n\n  base.bind(new Youku());\n\n  var combineParams$9 = util.combineParams,\n      getTime$5 = util.getTime;\n\n  function YouTube() {\n    this.provider = 'youtube';\n    this.alternatives = ['youtu', 'ytimg'];\n    this.defaultFormat = 'long';\n    this.formats = {\n      \"short\": this.createShortUrl,\n      \"long\": this.createLongUrl,\n      embed: this.createEmbedUrl,\n      shortImage: this.createShortImageUrl,\n      longImage: this.createLongImageUrl\n    };\n    this.imageQualities = {\n      '0': '0',\n      '1': '1',\n      '2': '2',\n      '3': '3',\n      DEFAULT: 'default',\n      HQDEFAULT: 'hqdefault',\n      SDDEFAULT: 'sddefault',\n      MQDEFAULT: 'mqdefault',\n      MAXRESDEFAULT: 'maxresdefault'\n    };\n    this.defaultImageQuality = this.imageQualities.HQDEFAULT;\n    this.mediaTypes = {\n      VIDEO: 'video',\n      PLAYLIST: 'playlist',\n      SHARE: 'share',\n      CHANNEL: 'channel'\n    };\n  }\n\n  YouTube.prototype.parseVideoUrl = function (url) {\n    var match = url.match(/(?:(?:v|vi|be|videos|embed)\\/(?!videoseries)|(?:v|ci)=)([\\w-]{11})/i);\n    return match ? match[1] : undefined;\n  };\n\n  YouTube.prototype.parseChannelUrl = function (url) {\n    // Match an opaque channel ID\n    var match = url.match(/\\/channel\\/([\\w-]+)/);\n\n    if (match) {\n      return {\n        id: match[1],\n        mediaType: this.mediaTypes.CHANNEL\n      };\n    } // Match a vanity channel name or a user name. User urls are deprecated and\n    // currently redirect to the channel of that same name.\n\n\n    match = url.match(/\\/(?:c|user)\\/([\\w-]+)/);\n\n    if (match) {\n      return {\n        name: match[1],\n        mediaType: this.mediaTypes.CHANNEL\n      };\n    }\n  };\n\n  YouTube.prototype.parseParameters = function (params, result) {\n    if (params.start || params.t) {\n      params.start = getTime$5(params.start || params.t);\n      delete params.t;\n    }\n\n    if (params.v === result.id) {\n      delete params.v;\n    }\n\n    if (params.list === result.id) {\n      delete params.list;\n    }\n\n    return params;\n  };\n\n  YouTube.prototype.parseMediaType = function (result) {\n    if (result.params.list) {\n      result.list = result.params.list;\n      delete result.params.list;\n    }\n\n    if (result.id && !result.params.ci) {\n      result.mediaType = this.mediaTypes.VIDEO;\n    } else if (result.list) {\n      delete result.id;\n      result.mediaType = this.mediaTypes.PLAYLIST;\n    } else if (result.params.ci) {\n      delete result.params.ci;\n      result.mediaType = this.mediaTypes.SHARE;\n    } else {\n      return undefined;\n    }\n\n    return result;\n  };\n\n  YouTube.prototype.parse = function (url, params) {\n    var channelResult = this.parseChannelUrl(url);\n\n    if (channelResult) {\n      return channelResult;\n    } else {\n      var result = {\n        params: params,\n        id: this.parseVideoUrl(url)\n      };\n      result.params = this.parseParameters(params, result);\n      result = this.parseMediaType(result);\n      return result;\n    }\n  };\n\n  YouTube.prototype.createShortUrl = function (vi, params) {\n    if (!vi.id || vi.mediaType !== this.mediaTypes.VIDEO) {\n      return undefined;\n    }\n\n    var url = 'https://youtu.be/' + vi.id;\n\n    if (params.start) {\n      url += '#t=' + params.start;\n    }\n\n    return url;\n  };\n\n  YouTube.prototype.createLongUrl = function (vi, params) {\n    var url = '';\n    var startTime = params.start;\n    delete params.start;\n\n    if (vi.mediaType === this.mediaTypes.CHANNEL) {\n      if (vi.id) {\n        url += 'https://www.youtube.com/channel/' + vi.id;\n      } else if (vi.name) {\n        url += 'https://www.youtube.com/c/' + vi.name;\n      } else {\n        return undefined;\n      }\n    } else if (vi.mediaType === this.mediaTypes.PLAYLIST && vi.list) {\n      params.feature = 'share';\n      url += 'https://www.youtube.com/playlist';\n    } else if (vi.mediaType === this.mediaTypes.VIDEO && vi.id) {\n      params.v = vi.id;\n      url += 'https://www.youtube.com/watch';\n    } else if (vi.mediaType === this.mediaTypes.SHARE && vi.id) {\n      params.ci = vi.id;\n      url += 'https://www.youtube.com/shared';\n    } else {\n      return undefined;\n    }\n\n    if (vi.list) {\n      params.list = vi.list;\n    }\n\n    url += combineParams$9(params);\n\n    if (vi.mediaType !== this.mediaTypes.PLAYLIST && startTime) {\n      url += '#t=' + startTime;\n    }\n\n    return url;\n  };\n\n  YouTube.prototype.createEmbedUrl = function (vi, params) {\n    var url = 'https://www.youtube.com/embed';\n\n    if (vi.mediaType === this.mediaTypes.PLAYLIST && vi.list) {\n      params.listType = 'playlist';\n    } else if (vi.mediaType === this.mediaTypes.VIDEO && vi.id) {\n      url += '/' + vi.id; //loop hack\n\n      if (params.loop === '1') {\n        params.playlist = vi.id;\n      }\n    } else {\n      return undefined;\n    }\n\n    if (vi.list) {\n      params.list = vi.list;\n    }\n\n    url += combineParams$9(params);\n    return url;\n  };\n\n  YouTube.prototype.createImageUrl = function (baseUrl, vi, params) {\n    if (!vi.id || vi.mediaType !== this.mediaTypes.VIDEO) {\n      return undefined;\n    }\n\n    var url = baseUrl + vi.id + '/';\n    var quality = params.imageQuality || this.defaultImageQuality;\n    return url + quality + '.jpg';\n  };\n\n  YouTube.prototype.createShortImageUrl = function (vi, params) {\n    return this.createImageUrl('https://i.ytimg.com/vi/', vi, params);\n  };\n\n  YouTube.prototype.createLongImageUrl = function (vi, params) {\n    return this.createImageUrl('https://img.youtube.com/vi/', vi, params);\n  };\n\n  base.bind(new YouTube());\n\n  var combineParams$a = util.combineParams,\n      getTime$6 = util.getTime;\n\n  function SoundCloud() {\n    this.provider = 'soundcloud';\n    this.defaultFormat = 'long';\n    this.formats = {\n      \"long\": this.createLongUrl,\n      embed: this.createEmbedUrl\n    };\n    this.mediaTypes = {\n      TRACK: 'track',\n      PLAYLIST: 'playlist',\n      APITRACK: 'apitrack',\n      APIPLAYLIST: 'apiplaylist'\n    };\n  }\n\n  SoundCloud.prototype.parseUrl = function (url, result) {\n    var match = url.match(/(?:m\\.)?soundcloud\\.com\\/(?:([\\w-]+)\\/(sets\\/)?)([\\w-]+)/i);\n\n    if (!match) {\n      return result;\n    }\n\n    result.channel = match[1];\n\n    if (match[1] === 'playlists' || match[2]) {\n      //playlist\n      result.list = match[3];\n    } else {\n      //track\n      result.id = match[3];\n    }\n\n    return result;\n  };\n\n  SoundCloud.prototype.parseParameters = function (params) {\n    if (params.t) {\n      params.start = getTime$6(params.t);\n      delete params.t;\n    }\n\n    return params;\n  };\n\n  SoundCloud.prototype.parseMediaType = function (result) {\n    if (result.id) {\n      if (result.channel === 'tracks') {\n        delete result.channel;\n        delete result.params.url;\n        result.mediaType = this.mediaTypes.APITRACK;\n      } else {\n        result.mediaType = this.mediaTypes.TRACK;\n      }\n    }\n\n    if (result.list) {\n      if (result.channel === 'playlists') {\n        delete result.channel;\n        delete result.params.url;\n        result.mediaType = this.mediaTypes.APIPLAYLIST;\n      } else {\n        result.mediaType = this.mediaTypes.PLAYLIST;\n      }\n    }\n\n    return result;\n  };\n\n  SoundCloud.prototype.parse = function (url, params) {\n    var result = {};\n    result = this.parseUrl(url, result);\n    result.params = this.parseParameters(params);\n    result = this.parseMediaType(result);\n\n    if (!result.id && !result.list) {\n      return undefined;\n    }\n\n    return result;\n  };\n\n  SoundCloud.prototype.createLongUrl = function (vi, params) {\n    var url = '';\n    var startTime = params.start;\n    delete params.start;\n\n    if (vi.mediaType === this.mediaTypes.TRACK && vi.id && vi.channel) {\n      url = 'https://soundcloud.com/' + vi.channel + '/' + vi.id;\n    } else if (vi.mediaType === this.mediaTypes.PLAYLIST && vi.list && vi.channel) {\n      url = 'https://soundcloud.com/' + vi.channel + '/sets/' + vi.list;\n    } else if (vi.mediaType === this.mediaTypes.APITRACK && vi.id) {\n      url = 'https://api.soundcloud.com/tracks/' + vi.id;\n    } else if (vi.mediaType === this.mediaTypes.APIPLAYLIST && vi.list) {\n      url = 'https://api.soundcloud.com/playlists/' + vi.list;\n    } else {\n      return undefined;\n    }\n\n    url += combineParams$a(params);\n\n    if (startTime) {\n      url += '#t=' + startTime;\n    }\n\n    return url;\n  };\n\n  SoundCloud.prototype.createEmbedUrl = function (vi, params) {\n    var url = 'https://w.soundcloud.com/player/';\n    delete params.start;\n\n    if (vi.mediaType === this.mediaTypes.APITRACK && vi.id) {\n      params.url = 'https%3A//api.soundcloud.com/tracks/' + vi.id;\n    } else if (vi.mediaType === this.mediaTypes.APIPLAYLIST && vi.list) {\n      params.url = 'https%3A//api.soundcloud.com/playlists/' + vi.list;\n    } else {\n      return undefined;\n    }\n\n    url += combineParams$a(params);\n    return url;\n  };\n\n  base.bind(new SoundCloud());\n\n  var combineParams$b = util.combineParams;\n\n  function TeacherTube() {\n    this.provider = 'teachertube';\n    this.alternatives = [];\n    this.defaultFormat = 'long';\n    this.formats = {\n      \"long\": this.createLongUrl,\n      embed: this.createEmbedUrl\n    };\n    this.mediaTypes = {\n      VIDEO: 'video',\n      AUDIO: 'audio',\n      DOCUMENT: 'document',\n      CHANNEL: 'channel',\n      COLLECTION: 'collection',\n      GROUP: 'group'\n    };\n  }\n\n  TeacherTube.prototype.parse = function (url, params) {\n    var result = {};\n    result.list = this.parsePlaylist(params);\n    result.params = params;\n    var match = url.match(/\\/(audio|video|document|user\\/channel|collection|group)\\/(?:[\\w-]+-)?(\\w+)/);\n\n    if (!match) {\n      return undefined;\n    }\n\n    result.mediaType = this.parseMediaType(match[1]);\n    result.id = match[2];\n    return result;\n  };\n\n  TeacherTube.prototype.parsePlaylist = function (params) {\n    if (params['playlist-id']) {\n      var list = params['playlist-id'];\n      delete params['playlist-id'];\n      return list;\n    }\n\n    return undefined;\n  };\n\n  TeacherTube.prototype.parseMediaType = function (mediaTypeMatch) {\n    switch (mediaTypeMatch) {\n      case 'audio':\n        return this.mediaTypes.AUDIO;\n\n      case 'video':\n        return this.mediaTypes.VIDEO;\n\n      case 'document':\n        return this.mediaTypes.DOCUMENT;\n\n      case 'user/channel':\n        return this.mediaTypes.CHANNEL;\n\n      case 'collection':\n        return this.mediaTypes.COLLECTION;\n\n      case 'group':\n        return this.mediaTypes.GROUP;\n    }\n  };\n\n  TeacherTube.prototype.createLongUrl = function (vi, params) {\n    if (!vi.id) {\n      return undefined;\n    }\n\n    var url = 'https://www.teachertube.com/';\n\n    if (vi.list) {\n      params['playlist-id'] = vi.list;\n    }\n\n    if (vi.mediaType === this.mediaTypes.CHANNEL) {\n      url += 'user/channel/';\n    } else {\n      url += vi.mediaType + '/';\n    }\n\n    url += vi.id;\n    url += combineParams$b(params);\n    return url;\n  };\n\n  TeacherTube.prototype.createEmbedUrl = function (vi, params) {\n    if (!vi.id) {\n      return undefined;\n    }\n\n    var url = 'https://www.teachertube.com/embed/';\n\n    if (vi.mediaType === this.mediaTypes.VIDEO || vi.mediaType === this.mediaTypes.AUDIO) {\n      url += vi.mediaType + '/' + vi.id;\n    } else {\n      return undefined;\n    }\n\n    url += combineParams$b(params);\n    return url;\n  };\n\n  base.bind(new TeacherTube());\n\n  var combineParams$c = util.combineParams;\n\n  function TikTok() {\n    this.provider = 'tiktok';\n    this.defaultFormat = 'long';\n    this.formats = {\n      \"long\": this.createLongUrl\n    };\n    this.mediaTypes = {\n      VIDEO: 'video'\n    };\n  }\n\n  TikTok.prototype.parse = function (url, params) {\n    var result = {\n      params: params,\n      mediaType: this.mediaTypes.VIDEO\n    };\n    var match = url.match(/@([^/]+)\\/video\\/(\\d{19})/);\n\n    if (!match) {\n      return;\n    }\n\n    result.channel = match[1];\n    result.id = match[2];\n    return result;\n  };\n\n  TikTok.prototype.createLongUrl = function (vi, params) {\n    var url = '';\n\n    if (vi.mediaType === this.mediaTypes.VIDEO && vi.id && vi.channel) {\n      url += \"https://www.tiktok.com/@\".concat(vi.channel, \"/video/\").concat(vi.id);\n    } else {\n      return undefined;\n    }\n\n    url += combineParams$c(params);\n    return url;\n  };\n\n  base.bind(new TikTok());\n\n  var combineParams$d = util.combineParams;\n\n  function Ted() {\n    this.provider = 'ted';\n    this.formats = {\n      \"long\": this.createLongUrl,\n      embed: this.createEmbedUrl\n    };\n    this.mediaTypes = {\n      VIDEO: 'video',\n      PLAYLIST: 'playlist'\n    };\n  }\n\n  Ted.prototype.parseUrl = function (url, result) {\n    var match = url.match(/\\/(talks|playlists\\/(\\d+))\\/([\\w-]+)/i);\n    var channel = match ? match[1] : undefined;\n\n    if (!channel) {\n      return result;\n    }\n\n    result.channel = channel.split('/')[0];\n    result.id = match[3];\n\n    if (result.channel === 'playlists') {\n      result.list = match[2];\n    }\n\n    return result;\n  };\n\n  Ted.prototype.parseMediaType = function (result) {\n    if (result.id && result.channel === 'playlists') {\n      delete result.channel;\n      result.mediaType = this.mediaTypes.PLAYLIST;\n    }\n\n    if (result.id && result.channel === 'talks') {\n      delete result.channel;\n      result.mediaType = this.mediaTypes.VIDEO;\n    }\n\n    return result;\n  };\n\n  Ted.prototype.parse = function (url, params) {\n    var result = {\n      params: params\n    };\n    result = this.parseUrl(url, result);\n    result = this.parseMediaType(result);\n\n    if (!result.id) {\n      return undefined;\n    }\n\n    return result;\n  };\n\n  Ted.prototype.createLongUrl = function (vi, params) {\n    var url = '';\n\n    if (vi.mediaType === this.mediaTypes.VIDEO && vi.id) {\n      url += 'https://ted.com/talks/' + vi.id;\n    } else if (vi.mediaType === this.mediaTypes.PLAYLIST && vi.id) {\n      url += 'https://ted.com/playlists/' + vi.list + '/' + vi.id;\n    } else {\n      return undefined;\n    }\n\n    url += combineParams$d(params);\n    return url;\n  };\n\n  Ted.prototype.createEmbedUrl = function (vi, params) {\n    var url = 'https://embed.ted.com/';\n\n    if (vi.mediaType === this.mediaTypes.PLAYLIST && vi.id) {\n      url += 'playlists/' + vi.list + '/' + vi.id;\n    } else if (vi.mediaType === this.mediaTypes.VIDEO && vi.id) {\n      url += 'talks/' + vi.id;\n    } else {\n      return undefined;\n    }\n\n    url += combineParams$d(params);\n    return url;\n  };\n\n  base.bind(new Ted());\n\n  var combineParams$e = util.combineParams;\n\n  function Facebook() {\n    this.provider = 'facebook';\n    this.alternatives = [];\n    this.defaultFormat = 'long';\n    this.formats = {\n      \"long\": this.createLongUrl,\n      watch: this.createWatchUrl\n    };\n    this.mediaTypes = {\n      VIDEO: 'video'\n    };\n  }\n\n  Facebook.prototype.parse = function (url, params) {\n    var result = {\n      params: params,\n      mediaType: this.mediaTypes.VIDEO\n    };\n    var match = url.match(/(?:\\/(\\d+))?\\/videos(?:\\/.*?)?\\/(\\d+)/i);\n\n    if (match) {\n      if (match[1]) {\n        result.pageId = match[1];\n      }\n\n      result.id = match[2];\n    }\n\n    if (params.v && !result.id) {\n      result.id = params.v;\n      delete params.v;\n      result.params = params;\n    }\n\n    if (!result.id) {\n      return undefined;\n    }\n\n    return result;\n  };\n\n  Facebook.prototype.createWatchUrl = function (vi, params) {\n    var url = 'https://facebook.com/watch/';\n\n    if (vi.mediaType !== this.mediaTypes.VIDEO || !vi.id) {\n      return undefined;\n    }\n\n    params = {\n      v: vi.id\n    };\n    url += combineParams$e(params);\n    return url;\n  };\n\n  Facebook.prototype.createLongUrl = function (vi, params) {\n    var url = 'https://facebook.com/';\n\n    if (vi.pageId) {\n      url += vi.pageId;\n    } else {\n      return undefined;\n    }\n\n    if (vi.mediaType === this.mediaTypes.VIDEO && vi.id) {\n      url += '/videos/' + vi.id;\n    } else {\n      return undefined;\n    }\n\n    url += combineParams$e(params);\n    return url;\n  };\n\n  base.bind(new Facebook());\n\n  var lib = base;\n\n  return lib;\n\n})));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2pzLXZpZGVvLXVybC1wYXJzZXIvZGlzdC9qc1ZpZGVvVXJsUGFyc2VyLmpzIiwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLi92dWUvZW50cmllcy9hZG1pbi9zZWdtZW50LWVkaXQudHMvLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2pzLXZpZGVvLXVybC1wYXJzZXIvZGlzdC9qc1ZpZGVvVXJsUGFyc2VyLmpzPzdkOGMiXSwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIChnbG9iYWwsIGZhY3RvcnkpIHtcbiAgdHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnID8gbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCkgOlxuICB0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgPyBkZWZpbmUoZmFjdG9yeSkgOlxuICAoZ2xvYmFsID0gZ2xvYmFsIHx8IHNlbGYsIGdsb2JhbC51cmxQYXJzZXIgPSBmYWN0b3J5KCkpO1xufSh0aGlzLCAoZnVuY3Rpb24gKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgZnVuY3Rpb24gX3R5cGVvZihvYmopIHtcbiAgICBcIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mXCI7XG5cbiAgICBpZiAodHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIpIHtcbiAgICAgIF90eXBlb2YgPSBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgIHJldHVybiB0eXBlb2Ygb2JqO1xuICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgX3R5cGVvZiA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7XG4gICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiBfdHlwZW9mKG9iaik7XG4gIH1cblxuICB2YXIgZ2V0UXVlcnlQYXJhbXMgPSBmdW5jdGlvbiBnZXRRdWVyeVBhcmFtcyhxcykge1xuICAgIGlmICh0eXBlb2YgcXMgIT09ICdzdHJpbmcnKSB7XG4gICAgICByZXR1cm4ge307XG4gICAgfVxuXG4gICAgcXMgPSBxcy5zcGxpdCgnKycpLmpvaW4oJyAnKTtcbiAgICB2YXIgcGFyYW1zID0ge307XG4gICAgdmFyIG1hdGNoID0gcXMubWF0Y2goLyg/Ols/XSg/OltePV0rKT0oPzpbXiYjXSopKD86WyZdKD86W149XSspPSg/OlteJiNdKikpKig/OlsjXS4qKT8pfCg/OlsjXS4qKS8pO1xuICAgIHZhciBzcGxpdDtcblxuICAgIGlmIChtYXRjaCA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuIHt9O1xuICAgIH1cblxuICAgIHNwbGl0ID0gbWF0Y2hbMF0uc3Vic3RyKDEpLnNwbGl0KC9bJiM9XS8pO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzcGxpdC5sZW5ndGg7IGkgKz0gMikge1xuICAgICAgcGFyYW1zW2RlY29kZVVSSUNvbXBvbmVudChzcGxpdFtpXSldID0gZGVjb2RlVVJJQ29tcG9uZW50KHNwbGl0W2kgKyAxXSB8fCAnJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHBhcmFtcztcbiAgfTtcblxuICB2YXIgY29tYmluZVBhcmFtcyA9IGZ1bmN0aW9uIGNvbWJpbmVQYXJhbXMocGFyYW1zLCBoYXNQYXJhbXMpIHtcbiAgICBpZiAoX3R5cGVvZihwYXJhbXMpICE9PSAnb2JqZWN0Jykge1xuICAgICAgcmV0dXJuICcnO1xuICAgIH1cblxuICAgIHZhciBjb21iaW5lZCA9ICcnO1xuICAgIHZhciBpID0gMDtcbiAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKHBhcmFtcyk7XG5cbiAgICBpZiAoa2V5cy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiAnJztcbiAgICB9IC8vYWx3YXlzIGhhdmUgcGFyYW1ldGVycyBpbiB0aGUgc2FtZSBvcmRlclxuXG5cbiAgICBrZXlzLnNvcnQoKTtcblxuICAgIGlmICghaGFzUGFyYW1zKSB7XG4gICAgICBjb21iaW5lZCArPSAnPycgKyBrZXlzWzBdICsgJz0nICsgcGFyYW1zW2tleXNbMF1dO1xuICAgICAgaSArPSAxO1xuICAgIH1cblxuICAgIGZvciAoOyBpIDwga2V5cy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgY29tYmluZWQgKz0gJyYnICsga2V5c1tpXSArICc9JyArIHBhcmFtc1trZXlzW2ldXTtcbiAgICB9XG5cbiAgICByZXR1cm4gY29tYmluZWQ7XG4gIH07IC8vcGFyc2VzIHN0cmluZ3MgbGlrZSAxaDMwbTIwcyB0byBzZWNvbmRzXG5cblxuICBmdW5jdGlvbiBnZXRMZXR0ZXJUaW1lKHRpbWVTdHJpbmcpIHtcbiAgICB2YXIgdG90YWxTZWNvbmRzID0gMDtcbiAgICB2YXIgdGltZVZhbHVlcyA9IHtcbiAgICAgICdzJzogMSxcbiAgICAgICdtJzogMSAqIDYwLFxuICAgICAgJ2gnOiAxICogNjAgKiA2MCxcbiAgICAgICdkJzogMSAqIDYwICogNjAgKiAyNCxcbiAgICAgICd3JzogMSAqIDYwICogNjAgKiAyNCAqIDdcbiAgICB9O1xuICAgIHZhciB0aW1lUGFpcnM7IC8vZXhwYW5kIHRvIFwiMSBoIDMwIG0gMjAgc1wiIGFuZCBzcGxpdFxuXG4gICAgdGltZVN0cmluZyA9IHRpbWVTdHJpbmcucmVwbGFjZSgvKFtzbWhkd10pL2csICcgJDEgJykudHJpbSgpO1xuICAgIHRpbWVQYWlycyA9IHRpbWVTdHJpbmcuc3BsaXQoJyAnKTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGltZVBhaXJzLmxlbmd0aDsgaSArPSAyKSB7XG4gICAgICB0b3RhbFNlY29uZHMgKz0gcGFyc2VJbnQodGltZVBhaXJzW2ldLCAxMCkgKiB0aW1lVmFsdWVzW3RpbWVQYWlyc1tpICsgMV0gfHwgJ3MnXTtcbiAgICB9XG5cbiAgICByZXR1cm4gdG90YWxTZWNvbmRzO1xuICB9IC8vcGFyc2VzIHN0cmluZ3MgbGlrZSAxOjMwOjIwIHRvIHNlY29uZHNcblxuXG4gIGZ1bmN0aW9uIGdldENvbG9uVGltZSh0aW1lU3RyaW5nKSB7XG4gICAgdmFyIHRvdGFsU2Vjb25kcyA9IDA7XG4gICAgdmFyIHRpbWVWYWx1ZXMgPSBbMSwgMSAqIDYwLCAxICogNjAgKiA2MCwgMSAqIDYwICogNjAgKiAyNCwgMSAqIDYwICogNjAgKiAyNCAqIDddO1xuICAgIHZhciB0aW1lUGFpcnMgPSB0aW1lU3RyaW5nLnNwbGl0KCc6Jyk7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRpbWVQYWlycy5sZW5ndGg7IGkrKykge1xuICAgICAgdG90YWxTZWNvbmRzICs9IHBhcnNlSW50KHRpbWVQYWlyc1tpXSwgMTApICogdGltZVZhbHVlc1t0aW1lUGFpcnMubGVuZ3RoIC0gaSAtIDFdO1xuICAgIH1cblxuICAgIHJldHVybiB0b3RhbFNlY29uZHM7XG4gIH1cblxuICB2YXIgZ2V0VGltZSA9IGZ1bmN0aW9uIGdldFRpbWUodGltZVN0cmluZykge1xuICAgIGlmICh0eXBlb2YgdGltZVN0cmluZyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cblxuICAgIGlmICh0aW1lU3RyaW5nLm1hdGNoKC9eKFxcZCtbc21oZHddPykrJC8pKSB7XG4gICAgICByZXR1cm4gZ2V0TGV0dGVyVGltZSh0aW1lU3RyaW5nKTtcbiAgICB9XG5cbiAgICBpZiAodGltZVN0cmluZy5tYXRjaCgvXihcXGQrOj8pKyQvKSkge1xuICAgICAgcmV0dXJuIGdldENvbG9uVGltZSh0aW1lU3RyaW5nKTtcbiAgICB9XG5cbiAgICByZXR1cm4gMDtcbiAgfTtcblxuICB2YXIgdXRpbCA9IHtcbiAgICBnZXRRdWVyeVBhcmFtczogZ2V0UXVlcnlQYXJhbXMsXG4gICAgY29tYmluZVBhcmFtczogY29tYmluZVBhcmFtcyxcbiAgICBnZXRUaW1lOiBnZXRUaW1lXG4gIH07XG5cbiAgdmFyIGdldFF1ZXJ5UGFyYW1zJDEgPSB1dGlsLmdldFF1ZXJ5UGFyYW1zO1xuXG4gIGZ1bmN0aW9uIFVybFBhcnNlcigpIHtcbiAgICBmb3IgKHZhciBfaSA9IDAsIF9hcnIgPSBbJ3BhcnNlUHJvdmlkZXInLCAncGFyc2UnLCAnYmluZCcsICdjcmVhdGUnXTsgX2kgPCBfYXJyLmxlbmd0aDsgX2krKykge1xuICAgICAgdmFyIGtleSA9IF9hcnJbX2ldO1xuICAgICAgdGhpc1trZXldID0gdGhpc1trZXldLmJpbmQodGhpcyk7XG4gICAgfVxuXG4gICAgdGhpcy5wbHVnaW5zID0ge307XG4gIH1cblxuICB2YXIgdXJsUGFyc2VyID0gVXJsUGFyc2VyO1xuXG4gIFVybFBhcnNlci5wcm90b3R5cGUucGFyc2VQcm92aWRlciA9IGZ1bmN0aW9uICh1cmwpIHtcbiAgICB2YXIgbWF0Y2ggPSB1cmwubWF0Y2goLyg/Oig/Omh0dHBzPzopP1xcL1xcLyk/KD86W14uXStcXC4pPyhcXHcrKVxcLi9pKTtcbiAgICByZXR1cm4gbWF0Y2ggPyBtYXRjaFsxXSA6IHVuZGVmaW5lZDtcbiAgfTtcblxuICBVcmxQYXJzZXIucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24gKHVybCkge1xuICAgIGlmICh0eXBlb2YgdXJsID09PSAndW5kZWZpbmVkJykge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICB2YXIgcHJvdmlkZXIgPSB0aGlzLnBhcnNlUHJvdmlkZXIodXJsKTtcbiAgICB2YXIgcmVzdWx0O1xuICAgIHZhciBwbHVnaW4gPSB0aGlzLnBsdWdpbnNbcHJvdmlkZXJdO1xuXG4gICAgaWYgKCFwcm92aWRlciB8fCAhcGx1Z2luIHx8ICFwbHVnaW4ucGFyc2UpIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgcmVzdWx0ID0gcGx1Z2luLnBhcnNlLmNhbGwocGx1Z2luLCB1cmwsIGdldFF1ZXJ5UGFyYW1zJDEodXJsKSk7XG5cbiAgICBpZiAocmVzdWx0KSB7XG4gICAgICByZXN1bHQgPSByZW1vdmVFbXB0eVBhcmFtZXRlcnMocmVzdWx0KTtcbiAgICAgIHJlc3VsdC5wcm92aWRlciA9IHBsdWdpbi5wcm92aWRlcjtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIFVybFBhcnNlci5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIChwbHVnaW4pIHtcbiAgICB0aGlzLnBsdWdpbnNbcGx1Z2luLnByb3ZpZGVyXSA9IHBsdWdpbjtcblxuICAgIGlmIChwbHVnaW4uYWx0ZXJuYXRpdmVzKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBsdWdpbi5hbHRlcm5hdGl2ZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgdGhpcy5wbHVnaW5zW3BsdWdpbi5hbHRlcm5hdGl2ZXNbaV1dID0gcGx1Z2luO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBVcmxQYXJzZXIucHJvdG90eXBlLmNyZWF0ZSA9IGZ1bmN0aW9uIChvcCkge1xuICAgIGlmIChfdHlwZW9mKG9wKSAhPT0gJ29iamVjdCcgfHwgX3R5cGVvZihvcC52aWRlb0luZm8pICE9PSAnb2JqZWN0Jykge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICB2YXIgdmkgPSBvcC52aWRlb0luZm87XG4gICAgdmFyIHBhcmFtcyA9IG9wLnBhcmFtcztcbiAgICB2YXIgcGx1Z2luID0gdGhpcy5wbHVnaW5zW3ZpLnByb3ZpZGVyXTtcbiAgICBwYXJhbXMgPSBwYXJhbXMgPT09ICdpbnRlcm5hbCcgPyB2aS5wYXJhbXMgOiBwYXJhbXMgfHwge307XG5cbiAgICBpZiAocGx1Z2luKSB7XG4gICAgICBvcC5mb3JtYXQgPSBvcC5mb3JtYXQgfHwgcGx1Z2luLmRlZmF1bHRGb3JtYXQ7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wcm90b3R5cGUtYnVpbHRpbnNcblxuICAgICAgaWYgKHBsdWdpbi5mb3JtYXRzLmhhc093blByb3BlcnR5KG9wLmZvcm1hdCkpIHtcbiAgICAgICAgcmV0dXJuIHBsdWdpbi5mb3JtYXRzW29wLmZvcm1hdF0uYXBwbHkocGx1Z2luLCBbdmksIE9iamVjdC5hc3NpZ24oe30sIHBhcmFtcyldKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9O1xuXG4gIGZ1bmN0aW9uIHJlbW92ZUVtcHR5UGFyYW1ldGVycyhyZXN1bHQpIHtcbiAgICBpZiAocmVzdWx0LnBhcmFtcyAmJiBPYmplY3Qua2V5cyhyZXN1bHQucGFyYW1zKS5sZW5ndGggPT09IDApIHtcbiAgICAgIGRlbGV0ZSByZXN1bHQucGFyYW1zO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICB2YXIgcGFyc2VyID0gbmV3IHVybFBhcnNlcigpO1xuICB2YXIgYmFzZSA9IHBhcnNlcjtcblxuICBmdW5jdGlvbiBBbGxvY2luZSgpIHtcbiAgICB0aGlzLnByb3ZpZGVyID0gJ2FsbG9jaW5lJztcbiAgICB0aGlzLmFsdGVybmF0aXZlcyA9IFtdO1xuICAgIHRoaXMuZGVmYXVsdEZvcm1hdCA9ICdlbWJlZCc7XG4gICAgdGhpcy5mb3JtYXRzID0ge1xuICAgICAgZW1iZWQ6IHRoaXMuY3JlYXRlRW1iZWRVcmxcbiAgICB9O1xuICAgIHRoaXMubWVkaWFUeXBlcyA9IHtcbiAgICAgIFZJREVPOiAndmlkZW8nXG4gICAgfTtcbiAgfVxuXG4gIEFsbG9jaW5lLnByb3RvdHlwZS5wYXJzZVVybCA9IGZ1bmN0aW9uICh1cmwpIHtcbiAgICB2YXIgbWF0Y2ggPSB1cmwubWF0Y2goLyg/OlxcL3ZpZGVvXFwvcGxheWVyX2dlbl9jbWVkaWE9KShbQS1aYS16MC05XSspL2kpO1xuICAgIHJldHVybiBtYXRjaCA/IG1hdGNoWzFdIDogdW5kZWZpbmVkO1xuICB9O1xuXG4gIEFsbG9jaW5lLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uICh1cmwpIHtcbiAgICB2YXIgcmVzdWx0ID0ge1xuICAgICAgbWVkaWFUeXBlOiB0aGlzLm1lZGlhVHlwZXMuVklERU8sXG4gICAgICBpZDogdGhpcy5wYXJzZVVybCh1cmwpXG4gICAgfTtcbiAgICByZXR1cm4gcmVzdWx0LmlkID8gcmVzdWx0IDogdW5kZWZpbmVkO1xuICB9O1xuXG4gIEFsbG9jaW5lLnByb3RvdHlwZS5jcmVhdGVFbWJlZFVybCA9IGZ1bmN0aW9uICh2aSkge1xuICAgIGlmICghdmkuaWQgfHwgdmkubWVkaWFUeXBlICE9PSB0aGlzLm1lZGlhVHlwZXMuVklERU8pIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgcmV0dXJuICdodHRwczovL3BsYXllci5hbGxvY2luZS5mci8nICsgdmkuaWQgKyAnLmh0bWwnO1xuICB9O1xuXG4gIGJhc2UuYmluZChuZXcgQWxsb2NpbmUoKSk7XG5cbiAgdmFyIGNvbWJpbmVQYXJhbXMkMSA9IHV0aWwuY29tYmluZVBhcmFtcztcblxuICBmdW5jdGlvbiBDYW5hbFBsdXMoKSB7XG4gICAgdGhpcy5wcm92aWRlciA9ICdjYW5hbHBsdXMnO1xuICAgIHRoaXMuZGVmYXVsdEZvcm1hdCA9ICdlbWJlZCc7XG4gICAgdGhpcy5mb3JtYXRzID0ge1xuICAgICAgZW1iZWQ6IHRoaXMuY3JlYXRlRW1iZWRVcmxcbiAgICB9O1xuICAgIHRoaXMubWVkaWFUeXBlcyA9IHtcbiAgICAgIFZJREVPOiAndmlkZW8nXG4gICAgfTtcbiAgfVxuXG4gIENhbmFsUGx1cy5wcm90b3R5cGUucGFyc2VQYXJhbWV0ZXJzID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgIGRlbGV0ZSBwYXJhbXMudmlkO1xuICAgIHJldHVybiBwYXJhbXM7XG4gIH07XG5cbiAgQ2FuYWxQbHVzLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uICh1cmwsIHBhcmFtcykge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICB2YXIgcmVzdWx0ID0ge1xuICAgICAgbWVkaWFUeXBlOiB0aGlzLm1lZGlhVHlwZXMuVklERU8sXG4gICAgICBpZDogcGFyYW1zLnZpZFxuICAgIH07XG4gICAgcmVzdWx0LnBhcmFtcyA9IF90aGlzLnBhcnNlUGFyYW1ldGVycyhwYXJhbXMpO1xuXG4gICAgaWYgKCFyZXN1bHQuaWQpIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICBDYW5hbFBsdXMucHJvdG90eXBlLmNyZWF0ZUVtYmVkVXJsID0gZnVuY3Rpb24gKHZpLCBwYXJhbXMpIHtcbiAgICBpZiAoIXZpLmlkIHx8IHZpLm1lZGlhVHlwZSAhPT0gdGhpcy5tZWRpYVR5cGVzLlZJREVPKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHZhciB1cmwgPSAnaHR0cDovL3BsYXllci5jYW5hbHBsdXMuZnIvZW1iZWQvJztcbiAgICBwYXJhbXMudmlkID0gdmkuaWQ7XG4gICAgdXJsICs9IGNvbWJpbmVQYXJhbXMkMShwYXJhbXMpO1xuICAgIHJldHVybiB1cmw7XG4gIH07XG5cbiAgYmFzZS5iaW5kKG5ldyBDYW5hbFBsdXMoKSk7XG5cbiAgdmFyIGNvbWJpbmVQYXJhbXMkMiA9IHV0aWwuY29tYmluZVBhcmFtcztcblxuICBmdW5jdGlvbiBDb3ViKCkge1xuICAgIHRoaXMucHJvdmlkZXIgPSAnY291Yic7XG4gICAgdGhpcy5kZWZhdWx0Rm9ybWF0ID0gJ2xvbmcnO1xuICAgIHRoaXMuZm9ybWF0cyA9IHtcbiAgICAgIFwibG9uZ1wiOiB0aGlzLmNyZWF0ZUxvbmdVcmwsXG4gICAgICBlbWJlZDogdGhpcy5jcmVhdGVFbWJlZFVybFxuICAgIH07XG4gICAgdGhpcy5tZWRpYVR5cGVzID0ge1xuICAgICAgVklERU86ICd2aWRlbydcbiAgICB9O1xuICB9XG5cbiAgQ291Yi5wcm90b3R5cGUucGFyc2VVcmwgPSBmdW5jdGlvbiAodXJsKSB7XG4gICAgdmFyIG1hdGNoID0gdXJsLm1hdGNoKC8oPzplbWJlZHx2aWV3KVxcLyhbYS16QS1aXFxkXSspL2kpO1xuICAgIHJldHVybiBtYXRjaCA/IG1hdGNoWzFdIDogdW5kZWZpbmVkO1xuICB9O1xuXG4gIENvdWIucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24gKHVybCwgcGFyYW1zKSB7XG4gICAgdmFyIHJlc3VsdCA9IHtcbiAgICAgIG1lZGlhVHlwZTogdGhpcy5tZWRpYVR5cGVzLlZJREVPLFxuICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICBpZDogdGhpcy5wYXJzZVVybCh1cmwpXG4gICAgfTtcblxuICAgIGlmICghcmVzdWx0LmlkKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG5cbiAgQ291Yi5wcm90b3R5cGUuY3JlYXRlVXJsID0gZnVuY3Rpb24gKGJhc2VVcmwsIHZpLCBwYXJhbXMpIHtcbiAgICBpZiAoIXZpLmlkIHx8IHZpLm1lZGlhVHlwZSAhPT0gdGhpcy5tZWRpYVR5cGVzLlZJREVPKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHZhciB1cmwgPSBiYXNlVXJsICsgdmkuaWQ7XG4gICAgdXJsICs9IGNvbWJpbmVQYXJhbXMkMihwYXJhbXMpO1xuICAgIHJldHVybiB1cmw7XG4gIH07XG5cbiAgQ291Yi5wcm90b3R5cGUuY3JlYXRlTG9uZ1VybCA9IGZ1bmN0aW9uICh2aSwgcGFyYW1zKSB7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlVXJsKCdodHRwczovL2NvdWIuY29tL3ZpZXcvJywgdmksIHBhcmFtcyk7XG4gIH07XG5cbiAgQ291Yi5wcm90b3R5cGUuY3JlYXRlRW1iZWRVcmwgPSBmdW5jdGlvbiAodmksIHBhcmFtcykge1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZVVybCgnLy9jb3ViLmNvbS9lbWJlZC8nLCB2aSwgcGFyYW1zKTtcbiAgfTtcblxuICBiYXNlLmJpbmQobmV3IENvdWIoKSk7XG5cbiAgdmFyIGNvbWJpbmVQYXJhbXMkMyA9IHV0aWwuY29tYmluZVBhcmFtcyxcbiAgICAgIGdldFRpbWUkMSA9IHV0aWwuZ2V0VGltZTtcblxuICBmdW5jdGlvbiBEYWlseW1vdGlvbigpIHtcbiAgICB0aGlzLnByb3ZpZGVyID0gJ2RhaWx5bW90aW9uJztcbiAgICB0aGlzLmFsdGVybmF0aXZlcyA9IFsnZGFpJ107XG4gICAgdGhpcy5kZWZhdWx0Rm9ybWF0ID0gJ2xvbmcnO1xuICAgIHRoaXMuZm9ybWF0cyA9IHtcbiAgICAgIFwic2hvcnRcIjogdGhpcy5jcmVhdGVTaG9ydFVybCxcbiAgICAgIFwibG9uZ1wiOiB0aGlzLmNyZWF0ZUxvbmdVcmwsXG4gICAgICBlbWJlZDogdGhpcy5jcmVhdGVFbWJlZFVybCxcbiAgICAgIGltYWdlOiB0aGlzLmNyZWF0ZUltYWdlVXJsXG4gICAgfTtcbiAgICB0aGlzLm1lZGlhVHlwZXMgPSB7XG4gICAgICBWSURFTzogJ3ZpZGVvJ1xuICAgIH07XG4gIH1cblxuICBEYWlseW1vdGlvbi5wcm90b3R5cGUucGFyc2VQYXJhbWV0ZXJzID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgIHJldHVybiB0aGlzLnBhcnNlVGltZShwYXJhbXMpO1xuICB9O1xuXG4gIERhaWx5bW90aW9uLnByb3RvdHlwZS5wYXJzZVRpbWUgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgaWYgKHBhcmFtcy5zdGFydCkge1xuICAgICAgcGFyYW1zLnN0YXJ0ID0gZ2V0VGltZSQxKHBhcmFtcy5zdGFydCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHBhcmFtcztcbiAgfTtcblxuICBEYWlseW1vdGlvbi5wcm90b3R5cGUucGFyc2VVcmwgPSBmdW5jdGlvbiAodXJsKSB7XG4gICAgdmFyIG1hdGNoID0gdXJsLm1hdGNoKC8oPzpcXC92aWRlb3xseSlcXC8oW0EtWmEtejAtOV0rKS9pKTtcbiAgICByZXR1cm4gbWF0Y2ggPyBtYXRjaFsxXSA6IHVuZGVmaW5lZDtcbiAgfTtcblxuICBEYWlseW1vdGlvbi5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbiAodXJsLCBwYXJhbXMpIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgdmFyIHJlc3VsdCA9IHtcbiAgICAgIG1lZGlhVHlwZTogdGhpcy5tZWRpYVR5cGVzLlZJREVPLFxuICAgICAgcGFyYW1zOiBfdGhpcy5wYXJzZVBhcmFtZXRlcnMocGFyYW1zKSxcbiAgICAgIGlkOiBfdGhpcy5wYXJzZVVybCh1cmwpXG4gICAgfTtcbiAgICByZXR1cm4gcmVzdWx0LmlkID8gcmVzdWx0IDogdW5kZWZpbmVkO1xuICB9O1xuXG4gIERhaWx5bW90aW9uLnByb3RvdHlwZS5jcmVhdGVVcmwgPSBmdW5jdGlvbiAoYmFzZSwgdmksIHBhcmFtcykge1xuICAgIGlmICghdmkuaWQgfHwgdmkubWVkaWFUeXBlICE9PSB0aGlzLm1lZGlhVHlwZXMuVklERU8pIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIGJhc2UgKyB2aS5pZCArIGNvbWJpbmVQYXJhbXMkMyhwYXJhbXMpO1xuICB9O1xuXG4gIERhaWx5bW90aW9uLnByb3RvdHlwZS5jcmVhdGVTaG9ydFVybCA9IGZ1bmN0aW9uICh2aSwgcGFyYW1zKSB7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlVXJsKCdodHRwczovL2RhaS5seS8nLCB2aSwgcGFyYW1zKTtcbiAgfTtcblxuICBEYWlseW1vdGlvbi5wcm90b3R5cGUuY3JlYXRlTG9uZ1VybCA9IGZ1bmN0aW9uICh2aSwgcGFyYW1zKSB7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlVXJsKCdodHRwczovL2RhaWx5bW90aW9uLmNvbS92aWRlby8nLCB2aSwgcGFyYW1zKTtcbiAgfTtcblxuICBEYWlseW1vdGlvbi5wcm90b3R5cGUuY3JlYXRlRW1iZWRVcmwgPSBmdW5jdGlvbiAodmksIHBhcmFtcykge1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZVVybCgnaHR0cHM6Ly93d3cuZGFpbHltb3Rpb24uY29tL2VtYmVkL3ZpZGVvLycsIHZpLCBwYXJhbXMpO1xuICB9O1xuXG4gIERhaWx5bW90aW9uLnByb3RvdHlwZS5jcmVhdGVJbWFnZVVybCA9IGZ1bmN0aW9uICh2aSwgcGFyYW1zKSB7XG4gICAgZGVsZXRlIHBhcmFtcy5zdGFydDtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVVcmwoJ2h0dHBzOi8vd3d3LmRhaWx5bW90aW9uLmNvbS90aHVtYm5haWwvdmlkZW8vJywgdmksIHBhcmFtcyk7XG4gIH07XG5cbiAgYmFzZS5iaW5kKG5ldyBEYWlseW1vdGlvbigpKTtcblxuICB2YXIgY29tYmluZVBhcmFtcyQ0ID0gdXRpbC5jb21iaW5lUGFyYW1zO1xuXG4gIGZ1bmN0aW9uIExvb20oKSB7XG4gICAgdGhpcy5wcm92aWRlciA9ICdsb29tJztcbiAgICB0aGlzLmRlZmF1bHRGb3JtYXQgPSAnbG9uZyc7XG4gICAgdGhpcy5mb3JtYXRzID0ge1xuICAgICAgXCJsb25nXCI6IHRoaXMuY3JlYXRlTG9uZ1VybCxcbiAgICAgIGVtYmVkOiB0aGlzLmNyZWF0ZUVtYmVkVXJsXG4gICAgfTtcbiAgICB0aGlzLm1lZGlhVHlwZXMgPSB7XG4gICAgICBWSURFTzogJ3ZpZGVvJ1xuICAgIH07XG4gIH1cblxuICBMb29tLnByb3RvdHlwZS5wYXJzZVVybCA9IGZ1bmN0aW9uICh1cmwpIHtcbiAgICB2YXIgbWF0Y2ggPSB1cmwubWF0Y2goLyg/OnNoYXJlfGVtYmVkKVxcLyhbYS16QS1aXFxkXSspL2kpO1xuICAgIHJldHVybiBtYXRjaCA/IG1hdGNoWzFdIDogdW5kZWZpbmVkO1xuICB9O1xuXG4gIExvb20ucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24gKHVybCwgcGFyYW1zKSB7XG4gICAgdmFyIHJlc3VsdCA9IHtcbiAgICAgIG1lZGlhVHlwZTogdGhpcy5tZWRpYVR5cGVzLlZJREVPLFxuICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICBpZDogdGhpcy5wYXJzZVVybCh1cmwpXG4gICAgfTtcbiAgICByZXR1cm4gcmVzdWx0LmlkID8gcmVzdWx0IDogdW5kZWZpbmVkO1xuICB9O1xuXG4gIExvb20ucHJvdG90eXBlLmNyZWF0ZVVybCA9IGZ1bmN0aW9uIChiYXNlVXJsLCB2aSwgcGFyYW1zKSB7XG4gICAgaWYgKCF2aS5pZCB8fCB2aS5tZWRpYVR5cGUgIT09IHRoaXMubWVkaWFUeXBlcy5WSURFTykge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICB2YXIgdXJsID0gYmFzZVVybCArIHZpLmlkO1xuICAgIHVybCArPSBjb21iaW5lUGFyYW1zJDQocGFyYW1zKTtcbiAgICByZXR1cm4gdXJsO1xuICB9O1xuXG4gIExvb20ucHJvdG90eXBlLmNyZWF0ZUxvbmdVcmwgPSBmdW5jdGlvbiAodmksIHBhcmFtcykge1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZVVybCgnaHR0cHM6Ly9sb29tLmNvbS9zaGFyZS8nLCB2aSwgcGFyYW1zKTtcbiAgfTtcblxuICBMb29tLnByb3RvdHlwZS5jcmVhdGVFbWJlZFVybCA9IGZ1bmN0aW9uICh2aSwgcGFyYW1zKSB7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlVXJsKCcvL2xvb20uY29tL2VtYmVkLycsIHZpLCBwYXJhbXMpO1xuICB9O1xuXG4gIGJhc2UuYmluZChuZXcgTG9vbSgpKTtcblxuICB2YXIgY29tYmluZVBhcmFtcyQ1ID0gdXRpbC5jb21iaW5lUGFyYW1zLFxuICAgICAgZ2V0VGltZSQyID0gdXRpbC5nZXRUaW1lO1xuXG4gIGZ1bmN0aW9uIFR3aXRjaCgpIHtcbiAgICB0aGlzLnByb3ZpZGVyID0gJ3R3aXRjaCc7XG4gICAgdGhpcy5kZWZhdWx0Rm9ybWF0ID0gJ2xvbmcnO1xuICAgIHRoaXMuZm9ybWF0cyA9IHtcbiAgICAgIFwibG9uZ1wiOiB0aGlzLmNyZWF0ZUxvbmdVcmwsXG4gICAgICBlbWJlZDogdGhpcy5jcmVhdGVFbWJlZFVybFxuICAgIH07XG4gICAgdGhpcy5tZWRpYVR5cGVzID0ge1xuICAgICAgVklERU86ICd2aWRlbycsXG4gICAgICBTVFJFQU06ICdzdHJlYW0nLFxuICAgICAgQ0xJUDogJ2NsaXAnXG4gICAgfTtcbiAgfVxuXG4gIFR3aXRjaC5wcm90b3R5cGUuc2VwZXJhdGVJZCA9IGZ1bmN0aW9uIChpZCkge1xuICAgIHJldHVybiB7XG4gICAgICBwcmU6IGlkWzBdLFxuICAgICAgaWQ6IGlkLnN1YnN0cigxKVxuICAgIH07XG4gIH07XG5cbiAgVHdpdGNoLnByb3RvdHlwZS5wYXJzZUNoYW5uZWwgPSBmdW5jdGlvbiAocmVzdWx0LCBwYXJhbXMpIHtcbiAgICB2YXIgY2hhbm5lbCA9IHBhcmFtcy5jaGFubmVsIHx8IHBhcmFtcy51dG1fY29udGVudCB8fCByZXN1bHQuY2hhbm5lbDtcbiAgICBkZWxldGUgcGFyYW1zLnV0bV9jb250ZW50O1xuICAgIGRlbGV0ZSBwYXJhbXMuY2hhbm5lbDtcbiAgICByZXR1cm4gY2hhbm5lbDtcbiAgfTtcblxuICBUd2l0Y2gucHJvdG90eXBlLnBhcnNlVXJsID0gZnVuY3Rpb24gKHVybCwgcmVzdWx0LCBwYXJhbXMpIHtcbiAgICB2YXIgbWF0Y2g7XG4gICAgbWF0Y2ggPSB1cmwubWF0Y2goLyhjbGlwc1xcLik/dHdpdGNoXFwudHZcXC8oPzooPzp2aWRlb3NcXC8oXFxkKykpfChcXHcrKD86LVtcXHdcXGQtXSspPykoPzpcXC9jbGlwXFwvKFxcdyspKT8pL2kpO1xuXG4gICAgaWYgKG1hdGNoICYmIG1hdGNoWzJdKSB7XG4gICAgICAvL3ZpZGVvXG4gICAgICByZXN1bHQuaWQgPSAndicgKyBtYXRjaFsyXTtcbiAgICB9IGVsc2UgaWYgKHBhcmFtcy52aWRlbykge1xuICAgICAgLy92aWRlbyBlbWJlZFxuICAgICAgcmVzdWx0LmlkID0gcGFyYW1zLnZpZGVvO1xuICAgICAgZGVsZXRlIHBhcmFtcy52aWRlbztcbiAgICB9IGVsc2UgaWYgKHBhcmFtcy5jbGlwKSB7XG4gICAgICAvL2NsaXBzIGVtYmVkXG4gICAgICByZXN1bHQuaWQgPSBwYXJhbXMuY2xpcDtcbiAgICAgIHJlc3VsdC5pc0NsaXAgPSB0cnVlO1xuICAgICAgZGVsZXRlIHBhcmFtcy5jbGlwO1xuICAgIH0gZWxzZSBpZiAobWF0Y2ggJiYgbWF0Y2hbMV0gJiYgbWF0Y2hbM10pIHtcbiAgICAgIC8vY2xpcHMudHdpdGNoLnR2L2lkXG4gICAgICByZXN1bHQuaWQgPSBtYXRjaFszXTtcbiAgICAgIHJlc3VsdC5pc0NsaXAgPSB0cnVlO1xuICAgIH0gZWxzZSBpZiAobWF0Y2ggJiYgbWF0Y2hbM10gJiYgbWF0Y2hbNF0pIHtcbiAgICAgIC8vdHdpdGNoLnR2L2NoYW5uZWwvY2xpcC9pZFxuICAgICAgcmVzdWx0LmNoYW5uZWwgPSBtYXRjaFszXTtcbiAgICAgIHJlc3VsdC5pZCA9IG1hdGNoWzRdO1xuICAgICAgcmVzdWx0LmlzQ2xpcCA9IHRydWU7XG4gICAgfSBlbHNlIGlmIChtYXRjaCAmJiBtYXRjaFszXSkge1xuICAgICAgcmVzdWx0LmNoYW5uZWwgPSBtYXRjaFszXTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIFR3aXRjaC5wcm90b3R5cGUucGFyc2VNZWRpYVR5cGUgPSBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgdmFyIG1lZGlhVHlwZTtcblxuICAgIGlmIChyZXN1bHQuaWQpIHtcbiAgICAgIGlmIChyZXN1bHQuaXNDbGlwKSB7XG4gICAgICAgIG1lZGlhVHlwZSA9IHRoaXMubWVkaWFUeXBlcy5DTElQO1xuICAgICAgICBkZWxldGUgcmVzdWx0LmlzQ2xpcDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1lZGlhVHlwZSA9IHRoaXMubWVkaWFUeXBlcy5WSURFTztcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHJlc3VsdC5jaGFubmVsKSB7XG4gICAgICBtZWRpYVR5cGUgPSB0aGlzLm1lZGlhVHlwZXMuU1RSRUFNO1xuICAgIH1cblxuICAgIHJldHVybiBtZWRpYVR5cGU7XG4gIH07XG5cbiAgVHdpdGNoLnByb3RvdHlwZS5wYXJzZVBhcmFtZXRlcnMgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgaWYgKHBhcmFtcy50KSB7XG4gICAgICBwYXJhbXMuc3RhcnQgPSBnZXRUaW1lJDIocGFyYW1zLnQpO1xuICAgICAgZGVsZXRlIHBhcmFtcy50O1xuICAgIH1cblxuICAgIHJldHVybiBwYXJhbXM7XG4gIH07XG5cbiAgVHdpdGNoLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uICh1cmwsIHBhcmFtcykge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgcmVzdWx0ID0gX3RoaXMucGFyc2VVcmwodXJsLCByZXN1bHQsIHBhcmFtcyk7XG4gICAgcmVzdWx0LmNoYW5uZWwgPSBfdGhpcy5wYXJzZUNoYW5uZWwocmVzdWx0LCBwYXJhbXMpO1xuICAgIHJlc3VsdC5tZWRpYVR5cGUgPSBfdGhpcy5wYXJzZU1lZGlhVHlwZShyZXN1bHQpO1xuICAgIHJlc3VsdC5wYXJhbXMgPSBfdGhpcy5wYXJzZVBhcmFtZXRlcnMocGFyYW1zKTtcbiAgICByZXR1cm4gcmVzdWx0LmNoYW5uZWwgfHwgcmVzdWx0LmlkID8gcmVzdWx0IDogdW5kZWZpbmVkO1xuICB9O1xuXG4gIFR3aXRjaC5wcm90b3R5cGUuY3JlYXRlTG9uZ1VybCA9IGZ1bmN0aW9uICh2aSwgcGFyYW1zKSB7XG4gICAgdmFyIHVybCA9ICcnO1xuXG4gICAgaWYgKHZpLm1lZGlhVHlwZSA9PT0gdGhpcy5tZWRpYVR5cGVzLlNUUkVBTSAmJiB2aS5jaGFubmVsKSB7XG4gICAgICB1cmwgPSAnaHR0cHM6Ly90d2l0Y2gudHYvJyArIHZpLmNoYW5uZWw7XG4gICAgfSBlbHNlIGlmICh2aS5tZWRpYVR5cGUgPT09IHRoaXMubWVkaWFUeXBlcy5WSURFTyAmJiB2aS5pZCkge1xuICAgICAgdmFyIHNlcCA9IHRoaXMuc2VwZXJhdGVJZCh2aS5pZCk7XG4gICAgICB1cmwgPSAnaHR0cHM6Ly90d2l0Y2gudHYvdmlkZW9zLycgKyBzZXAuaWQ7XG5cbiAgICAgIGlmIChwYXJhbXMuc3RhcnQpIHtcbiAgICAgICAgcGFyYW1zLnQgPSBwYXJhbXMuc3RhcnQgKyAncyc7XG4gICAgICAgIGRlbGV0ZSBwYXJhbXMuc3RhcnQ7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh2aS5tZWRpYVR5cGUgPT09IHRoaXMubWVkaWFUeXBlcy5DTElQICYmIHZpLmlkKSB7XG4gICAgICBpZiAodmkuY2hhbm5lbCkge1xuICAgICAgICB1cmwgPSAnaHR0cHM6Ly93d3cudHdpdGNoLnR2LycgKyB2aS5jaGFubmVsICsgJy9jbGlwLycgKyB2aS5pZDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHVybCA9ICdodHRwczovL2NsaXBzLnR3aXRjaC50di8nICsgdmkuaWQ7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgdXJsICs9IGNvbWJpbmVQYXJhbXMkNShwYXJhbXMpO1xuICAgIHJldHVybiB1cmw7XG4gIH07XG5cbiAgVHdpdGNoLnByb3RvdHlwZS5jcmVhdGVFbWJlZFVybCA9IGZ1bmN0aW9uICh2aSwgcGFyYW1zKSB7XG4gICAgdmFyIHVybCA9ICdodHRwczovL3BsYXllci50d2l0Y2gudHYvJztcblxuICAgIGlmICh2aS5tZWRpYVR5cGUgPT09IHRoaXMubWVkaWFUeXBlcy5TVFJFQU0gJiYgdmkuY2hhbm5lbCkge1xuICAgICAgcGFyYW1zLmNoYW5uZWwgPSB2aS5jaGFubmVsO1xuICAgIH0gZWxzZSBpZiAodmkubWVkaWFUeXBlID09PSB0aGlzLm1lZGlhVHlwZXMuVklERU8gJiYgdmkuaWQpIHtcbiAgICAgIHBhcmFtcy52aWRlbyA9IHZpLmlkO1xuXG4gICAgICBpZiAocGFyYW1zLnN0YXJ0KSB7XG4gICAgICAgIHBhcmFtcy50ID0gcGFyYW1zLnN0YXJ0ICsgJ3MnO1xuICAgICAgICBkZWxldGUgcGFyYW1zLnN0YXJ0O1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodmkubWVkaWFUeXBlID09PSB0aGlzLm1lZGlhVHlwZXMuQ0xJUCAmJiB2aS5pZCkge1xuICAgICAgdXJsID0gJ2h0dHBzOi8vY2xpcHMudHdpdGNoLnR2L2VtYmVkJztcbiAgICAgIHBhcmFtcy5jbGlwID0gdmkuaWQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgdXJsICs9IGNvbWJpbmVQYXJhbXMkNShwYXJhbXMpO1xuICAgIHJldHVybiB1cmw7XG4gIH07XG5cbiAgYmFzZS5iaW5kKG5ldyBUd2l0Y2goKSk7XG5cbiAgdmFyIGNvbWJpbmVQYXJhbXMkNiA9IHV0aWwuY29tYmluZVBhcmFtcyxcbiAgICAgIGdldFRpbWUkMyA9IHV0aWwuZ2V0VGltZTtcblxuICBmdW5jdGlvbiBWaW1lbygpIHtcbiAgICB0aGlzLnByb3ZpZGVyID0gJ3ZpbWVvJztcbiAgICB0aGlzLmFsdGVybmF0aXZlcyA9IFsndmltZW9wcm8nXTtcbiAgICB0aGlzLmRlZmF1bHRGb3JtYXQgPSAnbG9uZyc7XG4gICAgdGhpcy5mb3JtYXRzID0ge1xuICAgICAgXCJsb25nXCI6IHRoaXMuY3JlYXRlTG9uZ1VybCxcbiAgICAgIGVtYmVkOiB0aGlzLmNyZWF0ZUVtYmVkVXJsXG4gICAgfTtcbiAgICB0aGlzLm1lZGlhVHlwZXMgPSB7XG4gICAgICBWSURFTzogJ3ZpZGVvJ1xuICAgIH07XG4gIH1cblxuICBWaW1lby5wcm90b3R5cGUucGFyc2VVcmwgPSBmdW5jdGlvbiAodXJsKSB7XG4gICAgdmFyIG1hdGNoID0gdXJsLm1hdGNoKC8oPzpcXC9zaG93Y2FzZVxcL1xcZCspPyg/OlxcLyg/OmNoYW5uZWxzXFwvW1xcd10rfCg/Oig/OmFsYnVtXFwvXFxkK3xncm91cHNcXC9bXFx3XSspXFwvKT92aWRlb3M/KSk/XFwvKFxcZCspL2kpO1xuICAgIHJldHVybiBtYXRjaCA/IG1hdGNoWzFdIDogdW5kZWZpbmVkO1xuICB9O1xuXG4gIFZpbWVvLnByb3RvdHlwZS5wYXJzZUhhc2ggPSBmdW5jdGlvbiAodXJsKSB7XG4gICAgdmFyIG1hdGNoID0gdXJsLm1hdGNoKC9cXC9cXGQrXFwvKFxcdyspJC9pKTtcbiAgICByZXR1cm4gbWF0Y2ggPyBtYXRjaFsxXSA6IHVuZGVmaW5lZDtcbiAgfTtcblxuICBWaW1lby5wcm90b3R5cGUucGFyc2VQYXJhbWV0ZXJzID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgIGlmIChwYXJhbXMudCkge1xuICAgICAgcGFyYW1zLnN0YXJ0ID0gZ2V0VGltZSQzKHBhcmFtcy50KTtcbiAgICAgIGRlbGV0ZSBwYXJhbXMudDtcbiAgICB9XG5cbiAgICBpZiAocGFyYW1zLmgpIHtcbiAgICAgIHBhcmFtcy5oYXNoID0gcGFyYW1zLmg7XG4gICAgICBkZWxldGUgcGFyYW1zLmg7XG4gICAgfVxuXG4gICAgcmV0dXJuIHBhcmFtcztcbiAgfTtcblxuICBWaW1lby5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbiAodXJsLCBwYXJhbXMpIHtcbiAgICB2YXIgcmVzdWx0ID0ge1xuICAgICAgbWVkaWFUeXBlOiB0aGlzLm1lZGlhVHlwZXMuVklERU8sXG4gICAgICBwYXJhbXM6IHRoaXMucGFyc2VQYXJhbWV0ZXJzKHBhcmFtcyksXG4gICAgICBpZDogdGhpcy5wYXJzZVVybCh1cmwpXG4gICAgfTtcbiAgICB2YXIgaGFzaCA9IHRoaXMucGFyc2VIYXNoKHVybCwgcGFyYW1zKTtcblxuICAgIGlmIChoYXNoKSB7XG4gICAgICByZXN1bHQucGFyYW1zLmhhc2ggPSBoYXNoO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQuaWQgPyByZXN1bHQgOiB1bmRlZmluZWQ7XG4gIH07XG5cbiAgVmltZW8ucHJvdG90eXBlLmNyZWF0ZVVybCA9IGZ1bmN0aW9uIChiYXNlVXJsLCB2aSwgcGFyYW1zLCB0eXBlKSB7XG4gICAgaWYgKCF2aS5pZCB8fCB2aS5tZWRpYVR5cGUgIT09IHRoaXMubWVkaWFUeXBlcy5WSURFTykge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICB2YXIgdXJsID0gYmFzZVVybCArIHZpLmlkO1xuICAgIHZhciBzdGFydFRpbWUgPSBwYXJhbXMuc3RhcnQ7XG4gICAgZGVsZXRlIHBhcmFtcy5zdGFydDtcblxuICAgIGlmIChwYXJhbXMuaGFzaCkge1xuICAgICAgaWYgKHR5cGUgPT09ICdlbWJlZCcpIHtcbiAgICAgICAgcGFyYW1zLmggPSBwYXJhbXMuaGFzaDtcbiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ2xvbmcnKSB7XG4gICAgICAgIHVybCArPSAnLycgKyBwYXJhbXMuaGFzaDtcbiAgICAgIH1cblxuICAgICAgZGVsZXRlIHBhcmFtcy5oYXNoO1xuICAgIH1cblxuICAgIHVybCArPSBjb21iaW5lUGFyYW1zJDYocGFyYW1zKTtcblxuICAgIGlmIChzdGFydFRpbWUpIHtcbiAgICAgIHVybCArPSAnI3Q9JyArIHN0YXJ0VGltZTtcbiAgICB9XG5cbiAgICByZXR1cm4gdXJsO1xuICB9O1xuXG4gIFZpbWVvLnByb3RvdHlwZS5jcmVhdGVMb25nVXJsID0gZnVuY3Rpb24gKHZpLCBwYXJhbXMpIHtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVVcmwoJ2h0dHBzOi8vdmltZW8uY29tLycsIHZpLCBwYXJhbXMsICdsb25nJyk7XG4gIH07XG5cbiAgVmltZW8ucHJvdG90eXBlLmNyZWF0ZUVtYmVkVXJsID0gZnVuY3Rpb24gKHZpLCBwYXJhbXMpIHtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVVcmwoJy8vcGxheWVyLnZpbWVvLmNvbS92aWRlby8nLCB2aSwgcGFyYW1zLCAnZW1iZWQnKTtcbiAgfTtcblxuICBiYXNlLmJpbmQobmV3IFZpbWVvKCkpO1xuXG4gIHZhciBjb21iaW5lUGFyYW1zJDcgPSB1dGlsLmNvbWJpbmVQYXJhbXMsXG4gICAgICBnZXRUaW1lJDQgPSB1dGlsLmdldFRpbWU7XG5cbiAgZnVuY3Rpb24gV2lzdGlhKCkge1xuICAgIHRoaXMucHJvdmlkZXIgPSAnd2lzdGlhJztcbiAgICB0aGlzLmFsdGVybmF0aXZlcyA9IFtdO1xuICAgIHRoaXMuZGVmYXVsdEZvcm1hdCA9ICdsb25nJztcbiAgICB0aGlzLmZvcm1hdHMgPSB7XG4gICAgICBcImxvbmdcIjogdGhpcy5jcmVhdGVMb25nVXJsLFxuICAgICAgZW1iZWQ6IHRoaXMuY3JlYXRlRW1iZWRVcmwsXG4gICAgICBlbWJlZGpzb25wOiB0aGlzLmNyZWF0ZUVtYmVkSnNvbnBVcmxcbiAgICB9O1xuICAgIHRoaXMubWVkaWFUeXBlcyA9IHtcbiAgICAgIFZJREVPOiAndmlkZW8nLFxuICAgICAgRU1CRURWSURFTzogJ2VtYmVkdmlkZW8nXG4gICAgfTtcbiAgfVxuXG4gIFdpc3RpYS5wcm90b3R5cGUucGFyc2VVcmwgPSBmdW5jdGlvbiAodXJsKSB7XG4gICAgdmFyIG1hdGNoID0gdXJsLm1hdGNoKC8oPzooPzptZWRpYXN8aWZyYW1lKVxcL3x3dmlkZW89KShbXFx3LV0rKS8pO1xuICAgIHJldHVybiBtYXRjaCA/IG1hdGNoWzFdIDogdW5kZWZpbmVkO1xuICB9O1xuXG4gIFdpc3RpYS5wcm90b3R5cGUucGFyc2VDaGFubmVsID0gZnVuY3Rpb24gKHVybCkge1xuICAgIHZhciBtYXRjaCA9IHVybC5tYXRjaCgvKD86KD86aHR0cHM/Oik/XFwvXFwvKT8oW14uXSopXFwud2lzdGlhXFwuLyk7XG4gICAgdmFyIGNoYW5uZWwgPSBtYXRjaCA/IG1hdGNoWzFdIDogdW5kZWZpbmVkO1xuXG4gICAgaWYgKGNoYW5uZWwgPT09ICdmYXN0JyB8fCBjaGFubmVsID09PSAnY29udGVudCcpIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNoYW5uZWw7XG4gIH07XG5cbiAgV2lzdGlhLnByb3RvdHlwZS5wYXJzZVBhcmFtZXRlcnMgPSBmdW5jdGlvbiAocGFyYW1zLCByZXN1bHQpIHtcbiAgICBpZiAocGFyYW1zLnd0aW1lKSB7XG4gICAgICBwYXJhbXMuc3RhcnQgPSBnZXRUaW1lJDQocGFyYW1zLnd0aW1lKTtcbiAgICAgIGRlbGV0ZSBwYXJhbXMud3RpbWU7XG4gICAgfVxuXG4gICAgaWYgKHBhcmFtcy53dmlkZW8gPT09IHJlc3VsdC5pZCkge1xuICAgICAgZGVsZXRlIHBhcmFtcy53dmlkZW87XG4gICAgfVxuXG4gICAgcmV0dXJuIHBhcmFtcztcbiAgfTtcblxuICBXaXN0aWEucHJvdG90eXBlLnBhcnNlTWVkaWFUeXBlID0gZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgIGlmIChyZXN1bHQuaWQgJiYgcmVzdWx0LmNoYW5uZWwpIHtcbiAgICAgIHJldHVybiB0aGlzLm1lZGlhVHlwZXMuVklERU87XG4gICAgfSBlbHNlIGlmIChyZXN1bHQuaWQpIHtcbiAgICAgIGRlbGV0ZSByZXN1bHQuY2hhbm5lbDtcbiAgICAgIHJldHVybiB0aGlzLm1lZGlhVHlwZXMuRU1CRURWSURFTztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gIH07XG5cbiAgV2lzdGlhLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uICh1cmwsIHBhcmFtcykge1xuICAgIHZhciByZXN1bHQgPSB7XG4gICAgICBpZDogdGhpcy5wYXJzZVVybCh1cmwpLFxuICAgICAgY2hhbm5lbDogdGhpcy5wYXJzZUNoYW5uZWwodXJsKVxuICAgIH07XG4gICAgcmVzdWx0LnBhcmFtcyA9IHRoaXMucGFyc2VQYXJhbWV0ZXJzKHBhcmFtcywgcmVzdWx0KTtcbiAgICByZXN1bHQubWVkaWFUeXBlID0gdGhpcy5wYXJzZU1lZGlhVHlwZShyZXN1bHQpO1xuXG4gICAgaWYgKCFyZXN1bHQuaWQpIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICBXaXN0aWEucHJvdG90eXBlLmNyZWF0ZVVybCA9IGZ1bmN0aW9uICh2aSwgcGFyYW1zLCB1cmwpIHtcbiAgICBpZiAocGFyYW1zLnN0YXJ0KSB7XG4gICAgICBwYXJhbXMud3RpbWUgPSBwYXJhbXMuc3RhcnQ7XG4gICAgICBkZWxldGUgcGFyYW1zLnN0YXJ0O1xuICAgIH1cblxuICAgIHVybCArPSBjb21iaW5lUGFyYW1zJDcocGFyYW1zKTtcbiAgICByZXR1cm4gdXJsO1xuICB9O1xuXG4gIFdpc3RpYS5wcm90b3R5cGUuY3JlYXRlTG9uZ1VybCA9IGZ1bmN0aW9uICh2aSwgcGFyYW1zKSB7XG4gICAgaWYgKCF2aS5pZCB8fCB2aS5tZWRpYVR5cGUgIT09IHRoaXMubWVkaWFUeXBlcy5WSURFTykge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICB2YXIgdXJsID0gJ2h0dHBzOi8vJyArIHZpLmNoYW5uZWwgKyAnLndpc3RpYS5jb20vbWVkaWFzLycgKyB2aS5pZDtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVVcmwodmksIHBhcmFtcywgdXJsKTtcbiAgfTtcblxuICBXaXN0aWEucHJvdG90eXBlLmNyZWF0ZUVtYmVkVXJsID0gZnVuY3Rpb24gKHZpLCBwYXJhbXMpIHtcbiAgICBpZiAoIXZpLmlkIHx8ICEodmkubWVkaWFUeXBlID09PSB0aGlzLm1lZGlhVHlwZXMuVklERU8gfHwgdmkubWVkaWFUeXBlID09PSB0aGlzLm1lZGlhVHlwZXMuRU1CRURWSURFTykpIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgdmFyIHVybCA9ICdodHRwczovL2Zhc3Qud2lzdGlhLmNvbS9lbWJlZC9pZnJhbWUvJyArIHZpLmlkO1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZVVybCh2aSwgcGFyYW1zLCB1cmwpO1xuICB9O1xuXG4gIFdpc3RpYS5wcm90b3R5cGUuY3JlYXRlRW1iZWRKc29ucFVybCA9IGZ1bmN0aW9uICh2aSkge1xuICAgIGlmICghdmkuaWQgfHwgISh2aS5tZWRpYVR5cGUgPT09IHRoaXMubWVkaWFUeXBlcy5WSURFTyB8fCB2aS5tZWRpYVR5cGUgPT09IHRoaXMubWVkaWFUeXBlcy5FTUJFRFZJREVPKSkge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICByZXR1cm4gJ2h0dHBzOi8vZmFzdC53aXN0aWEuY29tL2VtYmVkL21lZGlhcy8nICsgdmkuaWQgKyAnLmpzb25wJztcbiAgfTtcblxuICBiYXNlLmJpbmQobmV3IFdpc3RpYSgpKTtcblxuICB2YXIgY29tYmluZVBhcmFtcyQ4ID0gdXRpbC5jb21iaW5lUGFyYW1zO1xuXG4gIGZ1bmN0aW9uIFlvdWt1KCkge1xuICAgIHRoaXMucHJvdmlkZXIgPSAneW91a3UnO1xuICAgIHRoaXMuZGVmYXVsdEZvcm1hdCA9ICdsb25nJztcbiAgICB0aGlzLmZvcm1hdHMgPSB7XG4gICAgICBlbWJlZDogdGhpcy5jcmVhdGVFbWJlZFVybCxcbiAgICAgIFwibG9uZ1wiOiB0aGlzLmNyZWF0ZUxvbmdVcmwsXG4gICAgICBmbGFzaDogdGhpcy5jcmVhdGVGbGFzaFVybCxcbiAgICAgIFwic3RhdGljXCI6IHRoaXMuY3JlYXRlU3RhdGljVXJsXG4gICAgfTtcbiAgICB0aGlzLm1lZGlhVHlwZXMgPSB7XG4gICAgICBWSURFTzogJ3ZpZGVvJ1xuICAgIH07XG4gIH1cblxuICBZb3VrdS5wcm90b3R5cGUucGFyc2VVcmwgPSBmdW5jdGlvbiAodXJsKSB7XG4gICAgdmFyIG1hdGNoID0gdXJsLm1hdGNoKC8oPzooPzplbWJlZHxzaWQpXFwvfHZfc2hvd1xcL2lkX3xWaWRlb0lEUz0pKFthLXpBLVowLTldKykvKTtcbiAgICByZXR1cm4gbWF0Y2ggPyBtYXRjaFsxXSA6IHVuZGVmaW5lZDtcbiAgfTtcblxuICBZb3VrdS5wcm90b3R5cGUucGFyc2VQYXJhbWV0ZXJzID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgIGlmIChwYXJhbXMuVmlkZW9JRFMpIHtcbiAgICAgIGRlbGV0ZSBwYXJhbXMuVmlkZW9JRFM7XG4gICAgfVxuXG4gICAgcmV0dXJuIHBhcmFtcztcbiAgfTtcblxuICBZb3VrdS5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbiAodXJsLCBwYXJhbXMpIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgdmFyIHJlc3VsdCA9IHtcbiAgICAgIG1lZGlhVHlwZTogdGhpcy5tZWRpYVR5cGVzLlZJREVPLFxuICAgICAgaWQ6IF90aGlzLnBhcnNlVXJsKHVybCksXG4gICAgICBwYXJhbXM6IF90aGlzLnBhcnNlUGFyYW1ldGVycyhwYXJhbXMpXG4gICAgfTtcblxuICAgIGlmICghcmVzdWx0LmlkKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG5cbiAgWW91a3UucHJvdG90eXBlLmNyZWF0ZVVybCA9IGZ1bmN0aW9uIChiYXNlVXJsLCB2aSwgcGFyYW1zKSB7XG4gICAgaWYgKCF2aS5pZCB8fCB2aS5tZWRpYVR5cGUgIT09IHRoaXMubWVkaWFUeXBlcy5WSURFTykge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICB2YXIgdXJsID0gYmFzZVVybCArIHZpLmlkO1xuICAgIHVybCArPSBjb21iaW5lUGFyYW1zJDgocGFyYW1zKTtcbiAgICByZXR1cm4gdXJsO1xuICB9O1xuXG4gIFlvdWt1LnByb3RvdHlwZS5jcmVhdGVFbWJlZFVybCA9IGZ1bmN0aW9uICh2aSwgcGFyYW1zKSB7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlVXJsKCdodHRwOi8vcGxheWVyLnlvdWt1LmNvbS9lbWJlZC8nLCB2aSwgcGFyYW1zKTtcbiAgfTtcblxuICBZb3VrdS5wcm90b3R5cGUuY3JlYXRlTG9uZ1VybCA9IGZ1bmN0aW9uICh2aSwgcGFyYW1zKSB7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlVXJsKCdodHRwOi8vdi55b3VrdS5jb20vdl9zaG93L2lkXycsIHZpLCBwYXJhbXMpO1xuICB9O1xuXG4gIFlvdWt1LnByb3RvdHlwZS5jcmVhdGVTdGF0aWNVcmwgPSBmdW5jdGlvbiAodmksIHBhcmFtcykge1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZVVybCgnaHR0cDovL3N0YXRpYy55b3VrdS5jb20vdjEuMC4wNjM4L3Yvc3dmL2xvYWRlci5zd2Y/VmlkZW9JRFM9JywgdmksIHBhcmFtcyk7XG4gIH07XG5cbiAgWW91a3UucHJvdG90eXBlLmNyZWF0ZUZsYXNoVXJsID0gZnVuY3Rpb24gKHZpLCBwYXJhbXMpIHtcbiAgICBpZiAoIXZpLmlkIHx8IHZpLm1lZGlhVHlwZSAhPT0gdGhpcy5tZWRpYVR5cGVzLlZJREVPKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHZhciB1cmwgPSAnaHR0cDovL3BsYXllci55b3VrdS5jb20vcGxheWVyLnBocC9zaWQvJyArIHZpLmlkICsgJy92LnN3Zic7XG4gICAgdXJsICs9IGNvbWJpbmVQYXJhbXMkOChwYXJhbXMpO1xuICAgIHJldHVybiB1cmw7XG4gIH07XG5cbiAgYmFzZS5iaW5kKG5ldyBZb3VrdSgpKTtcblxuICB2YXIgY29tYmluZVBhcmFtcyQ5ID0gdXRpbC5jb21iaW5lUGFyYW1zLFxuICAgICAgZ2V0VGltZSQ1ID0gdXRpbC5nZXRUaW1lO1xuXG4gIGZ1bmN0aW9uIFlvdVR1YmUoKSB7XG4gICAgdGhpcy5wcm92aWRlciA9ICd5b3V0dWJlJztcbiAgICB0aGlzLmFsdGVybmF0aXZlcyA9IFsneW91dHUnLCAneXRpbWcnXTtcbiAgICB0aGlzLmRlZmF1bHRGb3JtYXQgPSAnbG9uZyc7XG4gICAgdGhpcy5mb3JtYXRzID0ge1xuICAgICAgXCJzaG9ydFwiOiB0aGlzLmNyZWF0ZVNob3J0VXJsLFxuICAgICAgXCJsb25nXCI6IHRoaXMuY3JlYXRlTG9uZ1VybCxcbiAgICAgIGVtYmVkOiB0aGlzLmNyZWF0ZUVtYmVkVXJsLFxuICAgICAgc2hvcnRJbWFnZTogdGhpcy5jcmVhdGVTaG9ydEltYWdlVXJsLFxuICAgICAgbG9uZ0ltYWdlOiB0aGlzLmNyZWF0ZUxvbmdJbWFnZVVybFxuICAgIH07XG4gICAgdGhpcy5pbWFnZVF1YWxpdGllcyA9IHtcbiAgICAgICcwJzogJzAnLFxuICAgICAgJzEnOiAnMScsXG4gICAgICAnMic6ICcyJyxcbiAgICAgICczJzogJzMnLFxuICAgICAgREVGQVVMVDogJ2RlZmF1bHQnLFxuICAgICAgSFFERUZBVUxUOiAnaHFkZWZhdWx0JyxcbiAgICAgIFNEREVGQVVMVDogJ3NkZGVmYXVsdCcsXG4gICAgICBNUURFRkFVTFQ6ICdtcWRlZmF1bHQnLFxuICAgICAgTUFYUkVTREVGQVVMVDogJ21heHJlc2RlZmF1bHQnXG4gICAgfTtcbiAgICB0aGlzLmRlZmF1bHRJbWFnZVF1YWxpdHkgPSB0aGlzLmltYWdlUXVhbGl0aWVzLkhRREVGQVVMVDtcbiAgICB0aGlzLm1lZGlhVHlwZXMgPSB7XG4gICAgICBWSURFTzogJ3ZpZGVvJyxcbiAgICAgIFBMQVlMSVNUOiAncGxheWxpc3QnLFxuICAgICAgU0hBUkU6ICdzaGFyZScsXG4gICAgICBDSEFOTkVMOiAnY2hhbm5lbCdcbiAgICB9O1xuICB9XG5cbiAgWW91VHViZS5wcm90b3R5cGUucGFyc2VWaWRlb1VybCA9IGZ1bmN0aW9uICh1cmwpIHtcbiAgICB2YXIgbWF0Y2ggPSB1cmwubWF0Y2goLyg/Oig/OnZ8dml8YmV8dmlkZW9zfGVtYmVkKVxcLyg/IXZpZGVvc2VyaWVzKXwoPzp2fGNpKT0pKFtcXHctXXsxMX0pL2kpO1xuICAgIHJldHVybiBtYXRjaCA/IG1hdGNoWzFdIDogdW5kZWZpbmVkO1xuICB9O1xuXG4gIFlvdVR1YmUucHJvdG90eXBlLnBhcnNlQ2hhbm5lbFVybCA9IGZ1bmN0aW9uICh1cmwpIHtcbiAgICAvLyBNYXRjaCBhbiBvcGFxdWUgY2hhbm5lbCBJRFxuICAgIHZhciBtYXRjaCA9IHVybC5tYXRjaCgvXFwvY2hhbm5lbFxcLyhbXFx3LV0rKS8pO1xuXG4gICAgaWYgKG1hdGNoKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBpZDogbWF0Y2hbMV0sXG4gICAgICAgIG1lZGlhVHlwZTogdGhpcy5tZWRpYVR5cGVzLkNIQU5ORUxcbiAgICAgIH07XG4gICAgfSAvLyBNYXRjaCBhIHZhbml0eSBjaGFubmVsIG5hbWUgb3IgYSB1c2VyIG5hbWUuIFVzZXIgdXJscyBhcmUgZGVwcmVjYXRlZCBhbmRcbiAgICAvLyBjdXJyZW50bHkgcmVkaXJlY3QgdG8gdGhlIGNoYW5uZWwgb2YgdGhhdCBzYW1lIG5hbWUuXG5cblxuICAgIG1hdGNoID0gdXJsLm1hdGNoKC9cXC8oPzpjfHVzZXIpXFwvKFtcXHctXSspLyk7XG5cbiAgICBpZiAobWF0Y2gpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG5hbWU6IG1hdGNoWzFdLFxuICAgICAgICBtZWRpYVR5cGU6IHRoaXMubWVkaWFUeXBlcy5DSEFOTkVMXG4gICAgICB9O1xuICAgIH1cbiAgfTtcblxuICBZb3VUdWJlLnByb3RvdHlwZS5wYXJzZVBhcmFtZXRlcnMgPSBmdW5jdGlvbiAocGFyYW1zLCByZXN1bHQpIHtcbiAgICBpZiAocGFyYW1zLnN0YXJ0IHx8IHBhcmFtcy50KSB7XG4gICAgICBwYXJhbXMuc3RhcnQgPSBnZXRUaW1lJDUocGFyYW1zLnN0YXJ0IHx8IHBhcmFtcy50KTtcbiAgICAgIGRlbGV0ZSBwYXJhbXMudDtcbiAgICB9XG5cbiAgICBpZiAocGFyYW1zLnYgPT09IHJlc3VsdC5pZCkge1xuICAgICAgZGVsZXRlIHBhcmFtcy52O1xuICAgIH1cblxuICAgIGlmIChwYXJhbXMubGlzdCA9PT0gcmVzdWx0LmlkKSB7XG4gICAgICBkZWxldGUgcGFyYW1zLmxpc3Q7XG4gICAgfVxuXG4gICAgcmV0dXJuIHBhcmFtcztcbiAgfTtcblxuICBZb3VUdWJlLnByb3RvdHlwZS5wYXJzZU1lZGlhVHlwZSA9IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICBpZiAocmVzdWx0LnBhcmFtcy5saXN0KSB7XG4gICAgICByZXN1bHQubGlzdCA9IHJlc3VsdC5wYXJhbXMubGlzdDtcbiAgICAgIGRlbGV0ZSByZXN1bHQucGFyYW1zLmxpc3Q7XG4gICAgfVxuXG4gICAgaWYgKHJlc3VsdC5pZCAmJiAhcmVzdWx0LnBhcmFtcy5jaSkge1xuICAgICAgcmVzdWx0Lm1lZGlhVHlwZSA9IHRoaXMubWVkaWFUeXBlcy5WSURFTztcbiAgICB9IGVsc2UgaWYgKHJlc3VsdC5saXN0KSB7XG4gICAgICBkZWxldGUgcmVzdWx0LmlkO1xuICAgICAgcmVzdWx0Lm1lZGlhVHlwZSA9IHRoaXMubWVkaWFUeXBlcy5QTEFZTElTVDtcbiAgICB9IGVsc2UgaWYgKHJlc3VsdC5wYXJhbXMuY2kpIHtcbiAgICAgIGRlbGV0ZSByZXN1bHQucGFyYW1zLmNpO1xuICAgICAgcmVzdWx0Lm1lZGlhVHlwZSA9IHRoaXMubWVkaWFUeXBlcy5TSEFSRTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIFlvdVR1YmUucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24gKHVybCwgcGFyYW1zKSB7XG4gICAgdmFyIGNoYW5uZWxSZXN1bHQgPSB0aGlzLnBhcnNlQ2hhbm5lbFVybCh1cmwpO1xuXG4gICAgaWYgKGNoYW5uZWxSZXN1bHQpIHtcbiAgICAgIHJldHVybiBjaGFubmVsUmVzdWx0O1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgcmVzdWx0ID0ge1xuICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgaWQ6IHRoaXMucGFyc2VWaWRlb1VybCh1cmwpXG4gICAgICB9O1xuICAgICAgcmVzdWx0LnBhcmFtcyA9IHRoaXMucGFyc2VQYXJhbWV0ZXJzKHBhcmFtcywgcmVzdWx0KTtcbiAgICAgIHJlc3VsdCA9IHRoaXMucGFyc2VNZWRpYVR5cGUocmVzdWx0KTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICB9O1xuXG4gIFlvdVR1YmUucHJvdG90eXBlLmNyZWF0ZVNob3J0VXJsID0gZnVuY3Rpb24gKHZpLCBwYXJhbXMpIHtcbiAgICBpZiAoIXZpLmlkIHx8IHZpLm1lZGlhVHlwZSAhPT0gdGhpcy5tZWRpYVR5cGVzLlZJREVPKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHZhciB1cmwgPSAnaHR0cHM6Ly95b3V0dS5iZS8nICsgdmkuaWQ7XG5cbiAgICBpZiAocGFyYW1zLnN0YXJ0KSB7XG4gICAgICB1cmwgKz0gJyN0PScgKyBwYXJhbXMuc3RhcnQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIHVybDtcbiAgfTtcblxuICBZb3VUdWJlLnByb3RvdHlwZS5jcmVhdGVMb25nVXJsID0gZnVuY3Rpb24gKHZpLCBwYXJhbXMpIHtcbiAgICB2YXIgdXJsID0gJyc7XG4gICAgdmFyIHN0YXJ0VGltZSA9IHBhcmFtcy5zdGFydDtcbiAgICBkZWxldGUgcGFyYW1zLnN0YXJ0O1xuXG4gICAgaWYgKHZpLm1lZGlhVHlwZSA9PT0gdGhpcy5tZWRpYVR5cGVzLkNIQU5ORUwpIHtcbiAgICAgIGlmICh2aS5pZCkge1xuICAgICAgICB1cmwgKz0gJ2h0dHBzOi8vd3d3LnlvdXR1YmUuY29tL2NoYW5uZWwvJyArIHZpLmlkO1xuICAgICAgfSBlbHNlIGlmICh2aS5uYW1lKSB7XG4gICAgICAgIHVybCArPSAnaHR0cHM6Ly93d3cueW91dHViZS5jb20vYy8nICsgdmkubmFtZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh2aS5tZWRpYVR5cGUgPT09IHRoaXMubWVkaWFUeXBlcy5QTEFZTElTVCAmJiB2aS5saXN0KSB7XG4gICAgICBwYXJhbXMuZmVhdHVyZSA9ICdzaGFyZSc7XG4gICAgICB1cmwgKz0gJ2h0dHBzOi8vd3d3LnlvdXR1YmUuY29tL3BsYXlsaXN0JztcbiAgICB9IGVsc2UgaWYgKHZpLm1lZGlhVHlwZSA9PT0gdGhpcy5tZWRpYVR5cGVzLlZJREVPICYmIHZpLmlkKSB7XG4gICAgICBwYXJhbXMudiA9IHZpLmlkO1xuICAgICAgdXJsICs9ICdodHRwczovL3d3dy55b3V0dWJlLmNvbS93YXRjaCc7XG4gICAgfSBlbHNlIGlmICh2aS5tZWRpYVR5cGUgPT09IHRoaXMubWVkaWFUeXBlcy5TSEFSRSAmJiB2aS5pZCkge1xuICAgICAgcGFyYW1zLmNpID0gdmkuaWQ7XG4gICAgICB1cmwgKz0gJ2h0dHBzOi8vd3d3LnlvdXR1YmUuY29tL3NoYXJlZCc7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgaWYgKHZpLmxpc3QpIHtcbiAgICAgIHBhcmFtcy5saXN0ID0gdmkubGlzdDtcbiAgICB9XG5cbiAgICB1cmwgKz0gY29tYmluZVBhcmFtcyQ5KHBhcmFtcyk7XG5cbiAgICBpZiAodmkubWVkaWFUeXBlICE9PSB0aGlzLm1lZGlhVHlwZXMuUExBWUxJU1QgJiYgc3RhcnRUaW1lKSB7XG4gICAgICB1cmwgKz0gJyN0PScgKyBzdGFydFRpbWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIHVybDtcbiAgfTtcblxuICBZb3VUdWJlLnByb3RvdHlwZS5jcmVhdGVFbWJlZFVybCA9IGZ1bmN0aW9uICh2aSwgcGFyYW1zKSB7XG4gICAgdmFyIHVybCA9ICdodHRwczovL3d3dy55b3V0dWJlLmNvbS9lbWJlZCc7XG5cbiAgICBpZiAodmkubWVkaWFUeXBlID09PSB0aGlzLm1lZGlhVHlwZXMuUExBWUxJU1QgJiYgdmkubGlzdCkge1xuICAgICAgcGFyYW1zLmxpc3RUeXBlID0gJ3BsYXlsaXN0JztcbiAgICB9IGVsc2UgaWYgKHZpLm1lZGlhVHlwZSA9PT0gdGhpcy5tZWRpYVR5cGVzLlZJREVPICYmIHZpLmlkKSB7XG4gICAgICB1cmwgKz0gJy8nICsgdmkuaWQ7IC8vbG9vcCBoYWNrXG5cbiAgICAgIGlmIChwYXJhbXMubG9vcCA9PT0gJzEnKSB7XG4gICAgICAgIHBhcmFtcy5wbGF5bGlzdCA9IHZpLmlkO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIGlmICh2aS5saXN0KSB7XG4gICAgICBwYXJhbXMubGlzdCA9IHZpLmxpc3Q7XG4gICAgfVxuXG4gICAgdXJsICs9IGNvbWJpbmVQYXJhbXMkOShwYXJhbXMpO1xuICAgIHJldHVybiB1cmw7XG4gIH07XG5cbiAgWW91VHViZS5wcm90b3R5cGUuY3JlYXRlSW1hZ2VVcmwgPSBmdW5jdGlvbiAoYmFzZVVybCwgdmksIHBhcmFtcykge1xuICAgIGlmICghdmkuaWQgfHwgdmkubWVkaWFUeXBlICE9PSB0aGlzLm1lZGlhVHlwZXMuVklERU8pIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgdmFyIHVybCA9IGJhc2VVcmwgKyB2aS5pZCArICcvJztcbiAgICB2YXIgcXVhbGl0eSA9IHBhcmFtcy5pbWFnZVF1YWxpdHkgfHwgdGhpcy5kZWZhdWx0SW1hZ2VRdWFsaXR5O1xuICAgIHJldHVybiB1cmwgKyBxdWFsaXR5ICsgJy5qcGcnO1xuICB9O1xuXG4gIFlvdVR1YmUucHJvdG90eXBlLmNyZWF0ZVNob3J0SW1hZ2VVcmwgPSBmdW5jdGlvbiAodmksIHBhcmFtcykge1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZUltYWdlVXJsKCdodHRwczovL2kueXRpbWcuY29tL3ZpLycsIHZpLCBwYXJhbXMpO1xuICB9O1xuXG4gIFlvdVR1YmUucHJvdG90eXBlLmNyZWF0ZUxvbmdJbWFnZVVybCA9IGZ1bmN0aW9uICh2aSwgcGFyYW1zKSB7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlSW1hZ2VVcmwoJ2h0dHBzOi8vaW1nLnlvdXR1YmUuY29tL3ZpLycsIHZpLCBwYXJhbXMpO1xuICB9O1xuXG4gIGJhc2UuYmluZChuZXcgWW91VHViZSgpKTtcblxuICB2YXIgY29tYmluZVBhcmFtcyRhID0gdXRpbC5jb21iaW5lUGFyYW1zLFxuICAgICAgZ2V0VGltZSQ2ID0gdXRpbC5nZXRUaW1lO1xuXG4gIGZ1bmN0aW9uIFNvdW5kQ2xvdWQoKSB7XG4gICAgdGhpcy5wcm92aWRlciA9ICdzb3VuZGNsb3VkJztcbiAgICB0aGlzLmRlZmF1bHRGb3JtYXQgPSAnbG9uZyc7XG4gICAgdGhpcy5mb3JtYXRzID0ge1xuICAgICAgXCJsb25nXCI6IHRoaXMuY3JlYXRlTG9uZ1VybCxcbiAgICAgIGVtYmVkOiB0aGlzLmNyZWF0ZUVtYmVkVXJsXG4gICAgfTtcbiAgICB0aGlzLm1lZGlhVHlwZXMgPSB7XG4gICAgICBUUkFDSzogJ3RyYWNrJyxcbiAgICAgIFBMQVlMSVNUOiAncGxheWxpc3QnLFxuICAgICAgQVBJVFJBQ0s6ICdhcGl0cmFjaycsXG4gICAgICBBUElQTEFZTElTVDogJ2FwaXBsYXlsaXN0J1xuICAgIH07XG4gIH1cblxuICBTb3VuZENsb3VkLnByb3RvdHlwZS5wYXJzZVVybCA9IGZ1bmN0aW9uICh1cmwsIHJlc3VsdCkge1xuICAgIHZhciBtYXRjaCA9IHVybC5tYXRjaCgvKD86bVxcLik/c291bmRjbG91ZFxcLmNvbVxcLyg/OihbXFx3LV0rKVxcLyhzZXRzXFwvKT8pKFtcXHctXSspL2kpO1xuXG4gICAgaWYgKCFtYXRjaCkge1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICByZXN1bHQuY2hhbm5lbCA9IG1hdGNoWzFdO1xuXG4gICAgaWYgKG1hdGNoWzFdID09PSAncGxheWxpc3RzJyB8fCBtYXRjaFsyXSkge1xuICAgICAgLy9wbGF5bGlzdFxuICAgICAgcmVzdWx0Lmxpc3QgPSBtYXRjaFszXTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy90cmFja1xuICAgICAgcmVzdWx0LmlkID0gbWF0Y2hbM107XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICBTb3VuZENsb3VkLnByb3RvdHlwZS5wYXJzZVBhcmFtZXRlcnMgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgaWYgKHBhcmFtcy50KSB7XG4gICAgICBwYXJhbXMuc3RhcnQgPSBnZXRUaW1lJDYocGFyYW1zLnQpO1xuICAgICAgZGVsZXRlIHBhcmFtcy50O1xuICAgIH1cblxuICAgIHJldHVybiBwYXJhbXM7XG4gIH07XG5cbiAgU291bmRDbG91ZC5wcm90b3R5cGUucGFyc2VNZWRpYVR5cGUgPSBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgaWYgKHJlc3VsdC5pZCkge1xuICAgICAgaWYgKHJlc3VsdC5jaGFubmVsID09PSAndHJhY2tzJykge1xuICAgICAgICBkZWxldGUgcmVzdWx0LmNoYW5uZWw7XG4gICAgICAgIGRlbGV0ZSByZXN1bHQucGFyYW1zLnVybDtcbiAgICAgICAgcmVzdWx0Lm1lZGlhVHlwZSA9IHRoaXMubWVkaWFUeXBlcy5BUElUUkFDSztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdC5tZWRpYVR5cGUgPSB0aGlzLm1lZGlhVHlwZXMuVFJBQ0s7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHJlc3VsdC5saXN0KSB7XG4gICAgICBpZiAocmVzdWx0LmNoYW5uZWwgPT09ICdwbGF5bGlzdHMnKSB7XG4gICAgICAgIGRlbGV0ZSByZXN1bHQuY2hhbm5lbDtcbiAgICAgICAgZGVsZXRlIHJlc3VsdC5wYXJhbXMudXJsO1xuICAgICAgICByZXN1bHQubWVkaWFUeXBlID0gdGhpcy5tZWRpYVR5cGVzLkFQSVBMQVlMSVNUO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0Lm1lZGlhVHlwZSA9IHRoaXMubWVkaWFUeXBlcy5QTEFZTElTVDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIFNvdW5kQ2xvdWQucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24gKHVybCwgcGFyYW1zKSB7XG4gICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgIHJlc3VsdCA9IHRoaXMucGFyc2VVcmwodXJsLCByZXN1bHQpO1xuICAgIHJlc3VsdC5wYXJhbXMgPSB0aGlzLnBhcnNlUGFyYW1ldGVycyhwYXJhbXMpO1xuICAgIHJlc3VsdCA9IHRoaXMucGFyc2VNZWRpYVR5cGUocmVzdWx0KTtcblxuICAgIGlmICghcmVzdWx0LmlkICYmICFyZXN1bHQubGlzdCkge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIFNvdW5kQ2xvdWQucHJvdG90eXBlLmNyZWF0ZUxvbmdVcmwgPSBmdW5jdGlvbiAodmksIHBhcmFtcykge1xuICAgIHZhciB1cmwgPSAnJztcbiAgICB2YXIgc3RhcnRUaW1lID0gcGFyYW1zLnN0YXJ0O1xuICAgIGRlbGV0ZSBwYXJhbXMuc3RhcnQ7XG5cbiAgICBpZiAodmkubWVkaWFUeXBlID09PSB0aGlzLm1lZGlhVHlwZXMuVFJBQ0sgJiYgdmkuaWQgJiYgdmkuY2hhbm5lbCkge1xuICAgICAgdXJsID0gJ2h0dHBzOi8vc291bmRjbG91ZC5jb20vJyArIHZpLmNoYW5uZWwgKyAnLycgKyB2aS5pZDtcbiAgICB9IGVsc2UgaWYgKHZpLm1lZGlhVHlwZSA9PT0gdGhpcy5tZWRpYVR5cGVzLlBMQVlMSVNUICYmIHZpLmxpc3QgJiYgdmkuY2hhbm5lbCkge1xuICAgICAgdXJsID0gJ2h0dHBzOi8vc291bmRjbG91ZC5jb20vJyArIHZpLmNoYW5uZWwgKyAnL3NldHMvJyArIHZpLmxpc3Q7XG4gICAgfSBlbHNlIGlmICh2aS5tZWRpYVR5cGUgPT09IHRoaXMubWVkaWFUeXBlcy5BUElUUkFDSyAmJiB2aS5pZCkge1xuICAgICAgdXJsID0gJ2h0dHBzOi8vYXBpLnNvdW5kY2xvdWQuY29tL3RyYWNrcy8nICsgdmkuaWQ7XG4gICAgfSBlbHNlIGlmICh2aS5tZWRpYVR5cGUgPT09IHRoaXMubWVkaWFUeXBlcy5BUElQTEFZTElTVCAmJiB2aS5saXN0KSB7XG4gICAgICB1cmwgPSAnaHR0cHM6Ly9hcGkuc291bmRjbG91ZC5jb20vcGxheWxpc3RzLycgKyB2aS5saXN0O1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHVybCArPSBjb21iaW5lUGFyYW1zJGEocGFyYW1zKTtcblxuICAgIGlmIChzdGFydFRpbWUpIHtcbiAgICAgIHVybCArPSAnI3Q9JyArIHN0YXJ0VGltZTtcbiAgICB9XG5cbiAgICByZXR1cm4gdXJsO1xuICB9O1xuXG4gIFNvdW5kQ2xvdWQucHJvdG90eXBlLmNyZWF0ZUVtYmVkVXJsID0gZnVuY3Rpb24gKHZpLCBwYXJhbXMpIHtcbiAgICB2YXIgdXJsID0gJ2h0dHBzOi8vdy5zb3VuZGNsb3VkLmNvbS9wbGF5ZXIvJztcbiAgICBkZWxldGUgcGFyYW1zLnN0YXJ0O1xuXG4gICAgaWYgKHZpLm1lZGlhVHlwZSA9PT0gdGhpcy5tZWRpYVR5cGVzLkFQSVRSQUNLICYmIHZpLmlkKSB7XG4gICAgICBwYXJhbXMudXJsID0gJ2h0dHBzJTNBLy9hcGkuc291bmRjbG91ZC5jb20vdHJhY2tzLycgKyB2aS5pZDtcbiAgICB9IGVsc2UgaWYgKHZpLm1lZGlhVHlwZSA9PT0gdGhpcy5tZWRpYVR5cGVzLkFQSVBMQVlMSVNUICYmIHZpLmxpc3QpIHtcbiAgICAgIHBhcmFtcy51cmwgPSAnaHR0cHMlM0EvL2FwaS5zb3VuZGNsb3VkLmNvbS9wbGF5bGlzdHMvJyArIHZpLmxpc3Q7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgdXJsICs9IGNvbWJpbmVQYXJhbXMkYShwYXJhbXMpO1xuICAgIHJldHVybiB1cmw7XG4gIH07XG5cbiAgYmFzZS5iaW5kKG5ldyBTb3VuZENsb3VkKCkpO1xuXG4gIHZhciBjb21iaW5lUGFyYW1zJGIgPSB1dGlsLmNvbWJpbmVQYXJhbXM7XG5cbiAgZnVuY3Rpb24gVGVhY2hlclR1YmUoKSB7XG4gICAgdGhpcy5wcm92aWRlciA9ICd0ZWFjaGVydHViZSc7XG4gICAgdGhpcy5hbHRlcm5hdGl2ZXMgPSBbXTtcbiAgICB0aGlzLmRlZmF1bHRGb3JtYXQgPSAnbG9uZyc7XG4gICAgdGhpcy5mb3JtYXRzID0ge1xuICAgICAgXCJsb25nXCI6IHRoaXMuY3JlYXRlTG9uZ1VybCxcbiAgICAgIGVtYmVkOiB0aGlzLmNyZWF0ZUVtYmVkVXJsXG4gICAgfTtcbiAgICB0aGlzLm1lZGlhVHlwZXMgPSB7XG4gICAgICBWSURFTzogJ3ZpZGVvJyxcbiAgICAgIEFVRElPOiAnYXVkaW8nLFxuICAgICAgRE9DVU1FTlQ6ICdkb2N1bWVudCcsXG4gICAgICBDSEFOTkVMOiAnY2hhbm5lbCcsXG4gICAgICBDT0xMRUNUSU9OOiAnY29sbGVjdGlvbicsXG4gICAgICBHUk9VUDogJ2dyb3VwJ1xuICAgIH07XG4gIH1cblxuICBUZWFjaGVyVHViZS5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbiAodXJsLCBwYXJhbXMpIHtcbiAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgcmVzdWx0Lmxpc3QgPSB0aGlzLnBhcnNlUGxheWxpc3QocGFyYW1zKTtcbiAgICByZXN1bHQucGFyYW1zID0gcGFyYW1zO1xuICAgIHZhciBtYXRjaCA9IHVybC5tYXRjaCgvXFwvKGF1ZGlvfHZpZGVvfGRvY3VtZW50fHVzZXJcXC9jaGFubmVsfGNvbGxlY3Rpb258Z3JvdXApXFwvKD86W1xcdy1dKy0pPyhcXHcrKS8pO1xuXG4gICAgaWYgKCFtYXRjaCkge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICByZXN1bHQubWVkaWFUeXBlID0gdGhpcy5wYXJzZU1lZGlhVHlwZShtYXRjaFsxXSk7XG4gICAgcmVzdWx0LmlkID0gbWF0Y2hbMl07XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICBUZWFjaGVyVHViZS5wcm90b3R5cGUucGFyc2VQbGF5bGlzdCA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICBpZiAocGFyYW1zWydwbGF5bGlzdC1pZCddKSB7XG4gICAgICB2YXIgbGlzdCA9IHBhcmFtc1sncGxheWxpc3QtaWQnXTtcbiAgICAgIGRlbGV0ZSBwYXJhbXNbJ3BsYXlsaXN0LWlkJ107XG4gICAgICByZXR1cm4gbGlzdDtcbiAgICB9XG5cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9O1xuXG4gIFRlYWNoZXJUdWJlLnByb3RvdHlwZS5wYXJzZU1lZGlhVHlwZSA9IGZ1bmN0aW9uIChtZWRpYVR5cGVNYXRjaCkge1xuICAgIHN3aXRjaCAobWVkaWFUeXBlTWF0Y2gpIHtcbiAgICAgIGNhc2UgJ2F1ZGlvJzpcbiAgICAgICAgcmV0dXJuIHRoaXMubWVkaWFUeXBlcy5BVURJTztcblxuICAgICAgY2FzZSAndmlkZW8nOlxuICAgICAgICByZXR1cm4gdGhpcy5tZWRpYVR5cGVzLlZJREVPO1xuXG4gICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgIHJldHVybiB0aGlzLm1lZGlhVHlwZXMuRE9DVU1FTlQ7XG5cbiAgICAgIGNhc2UgJ3VzZXIvY2hhbm5lbCc6XG4gICAgICAgIHJldHVybiB0aGlzLm1lZGlhVHlwZXMuQ0hBTk5FTDtcblxuICAgICAgY2FzZSAnY29sbGVjdGlvbic6XG4gICAgICAgIHJldHVybiB0aGlzLm1lZGlhVHlwZXMuQ09MTEVDVElPTjtcblxuICAgICAgY2FzZSAnZ3JvdXAnOlxuICAgICAgICByZXR1cm4gdGhpcy5tZWRpYVR5cGVzLkdST1VQO1xuICAgIH1cbiAgfTtcblxuICBUZWFjaGVyVHViZS5wcm90b3R5cGUuY3JlYXRlTG9uZ1VybCA9IGZ1bmN0aW9uICh2aSwgcGFyYW1zKSB7XG4gICAgaWYgKCF2aS5pZCkge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICB2YXIgdXJsID0gJ2h0dHBzOi8vd3d3LnRlYWNoZXJ0dWJlLmNvbS8nO1xuXG4gICAgaWYgKHZpLmxpc3QpIHtcbiAgICAgIHBhcmFtc1sncGxheWxpc3QtaWQnXSA9IHZpLmxpc3Q7XG4gICAgfVxuXG4gICAgaWYgKHZpLm1lZGlhVHlwZSA9PT0gdGhpcy5tZWRpYVR5cGVzLkNIQU5ORUwpIHtcbiAgICAgIHVybCArPSAndXNlci9jaGFubmVsLyc7XG4gICAgfSBlbHNlIHtcbiAgICAgIHVybCArPSB2aS5tZWRpYVR5cGUgKyAnLyc7XG4gICAgfVxuXG4gICAgdXJsICs9IHZpLmlkO1xuICAgIHVybCArPSBjb21iaW5lUGFyYW1zJGIocGFyYW1zKTtcbiAgICByZXR1cm4gdXJsO1xuICB9O1xuXG4gIFRlYWNoZXJUdWJlLnByb3RvdHlwZS5jcmVhdGVFbWJlZFVybCA9IGZ1bmN0aW9uICh2aSwgcGFyYW1zKSB7XG4gICAgaWYgKCF2aS5pZCkge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICB2YXIgdXJsID0gJ2h0dHBzOi8vd3d3LnRlYWNoZXJ0dWJlLmNvbS9lbWJlZC8nO1xuXG4gICAgaWYgKHZpLm1lZGlhVHlwZSA9PT0gdGhpcy5tZWRpYVR5cGVzLlZJREVPIHx8IHZpLm1lZGlhVHlwZSA9PT0gdGhpcy5tZWRpYVR5cGVzLkFVRElPKSB7XG4gICAgICB1cmwgKz0gdmkubWVkaWFUeXBlICsgJy8nICsgdmkuaWQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgdXJsICs9IGNvbWJpbmVQYXJhbXMkYihwYXJhbXMpO1xuICAgIHJldHVybiB1cmw7XG4gIH07XG5cbiAgYmFzZS5iaW5kKG5ldyBUZWFjaGVyVHViZSgpKTtcblxuICB2YXIgY29tYmluZVBhcmFtcyRjID0gdXRpbC5jb21iaW5lUGFyYW1zO1xuXG4gIGZ1bmN0aW9uIFRpa1RvaygpIHtcbiAgICB0aGlzLnByb3ZpZGVyID0gJ3Rpa3Rvayc7XG4gICAgdGhpcy5kZWZhdWx0Rm9ybWF0ID0gJ2xvbmcnO1xuICAgIHRoaXMuZm9ybWF0cyA9IHtcbiAgICAgIFwibG9uZ1wiOiB0aGlzLmNyZWF0ZUxvbmdVcmxcbiAgICB9O1xuICAgIHRoaXMubWVkaWFUeXBlcyA9IHtcbiAgICAgIFZJREVPOiAndmlkZW8nXG4gICAgfTtcbiAgfVxuXG4gIFRpa1Rvay5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbiAodXJsLCBwYXJhbXMpIHtcbiAgICB2YXIgcmVzdWx0ID0ge1xuICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICBtZWRpYVR5cGU6IHRoaXMubWVkaWFUeXBlcy5WSURFT1xuICAgIH07XG4gICAgdmFyIG1hdGNoID0gdXJsLm1hdGNoKC9AKFteL10rKVxcL3ZpZGVvXFwvKFxcZHsxOX0pLyk7XG5cbiAgICBpZiAoIW1hdGNoKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgcmVzdWx0LmNoYW5uZWwgPSBtYXRjaFsxXTtcbiAgICByZXN1bHQuaWQgPSBtYXRjaFsyXTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIFRpa1Rvay5wcm90b3R5cGUuY3JlYXRlTG9uZ1VybCA9IGZ1bmN0aW9uICh2aSwgcGFyYW1zKSB7XG4gICAgdmFyIHVybCA9ICcnO1xuXG4gICAgaWYgKHZpLm1lZGlhVHlwZSA9PT0gdGhpcy5tZWRpYVR5cGVzLlZJREVPICYmIHZpLmlkICYmIHZpLmNoYW5uZWwpIHtcbiAgICAgIHVybCArPSBcImh0dHBzOi8vd3d3LnRpa3Rvay5jb20vQFwiLmNvbmNhdCh2aS5jaGFubmVsLCBcIi92aWRlby9cIikuY29uY2F0KHZpLmlkKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICB1cmwgKz0gY29tYmluZVBhcmFtcyRjKHBhcmFtcyk7XG4gICAgcmV0dXJuIHVybDtcbiAgfTtcblxuICBiYXNlLmJpbmQobmV3IFRpa1RvaygpKTtcblxuICB2YXIgY29tYmluZVBhcmFtcyRkID0gdXRpbC5jb21iaW5lUGFyYW1zO1xuXG4gIGZ1bmN0aW9uIFRlZCgpIHtcbiAgICB0aGlzLnByb3ZpZGVyID0gJ3RlZCc7XG4gICAgdGhpcy5mb3JtYXRzID0ge1xuICAgICAgXCJsb25nXCI6IHRoaXMuY3JlYXRlTG9uZ1VybCxcbiAgICAgIGVtYmVkOiB0aGlzLmNyZWF0ZUVtYmVkVXJsXG4gICAgfTtcbiAgICB0aGlzLm1lZGlhVHlwZXMgPSB7XG4gICAgICBWSURFTzogJ3ZpZGVvJyxcbiAgICAgIFBMQVlMSVNUOiAncGxheWxpc3QnXG4gICAgfTtcbiAgfVxuXG4gIFRlZC5wcm90b3R5cGUucGFyc2VVcmwgPSBmdW5jdGlvbiAodXJsLCByZXN1bHQpIHtcbiAgICB2YXIgbWF0Y2ggPSB1cmwubWF0Y2goL1xcLyh0YWxrc3xwbGF5bGlzdHNcXC8oXFxkKykpXFwvKFtcXHctXSspL2kpO1xuICAgIHZhciBjaGFubmVsID0gbWF0Y2ggPyBtYXRjaFsxXSA6IHVuZGVmaW5lZDtcblxuICAgIGlmICghY2hhbm5lbCkge1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICByZXN1bHQuY2hhbm5lbCA9IGNoYW5uZWwuc3BsaXQoJy8nKVswXTtcbiAgICByZXN1bHQuaWQgPSBtYXRjaFszXTtcblxuICAgIGlmIChyZXN1bHQuY2hhbm5lbCA9PT0gJ3BsYXlsaXN0cycpIHtcbiAgICAgIHJlc3VsdC5saXN0ID0gbWF0Y2hbMl07XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICBUZWQucHJvdG90eXBlLnBhcnNlTWVkaWFUeXBlID0gZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgIGlmIChyZXN1bHQuaWQgJiYgcmVzdWx0LmNoYW5uZWwgPT09ICdwbGF5bGlzdHMnKSB7XG4gICAgICBkZWxldGUgcmVzdWx0LmNoYW5uZWw7XG4gICAgICByZXN1bHQubWVkaWFUeXBlID0gdGhpcy5tZWRpYVR5cGVzLlBMQVlMSVNUO1xuICAgIH1cblxuICAgIGlmIChyZXN1bHQuaWQgJiYgcmVzdWx0LmNoYW5uZWwgPT09ICd0YWxrcycpIHtcbiAgICAgIGRlbGV0ZSByZXN1bHQuY2hhbm5lbDtcbiAgICAgIHJlc3VsdC5tZWRpYVR5cGUgPSB0aGlzLm1lZGlhVHlwZXMuVklERU87XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICBUZWQucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24gKHVybCwgcGFyYW1zKSB7XG4gICAgdmFyIHJlc3VsdCA9IHtcbiAgICAgIHBhcmFtczogcGFyYW1zXG4gICAgfTtcbiAgICByZXN1bHQgPSB0aGlzLnBhcnNlVXJsKHVybCwgcmVzdWx0KTtcbiAgICByZXN1bHQgPSB0aGlzLnBhcnNlTWVkaWFUeXBlKHJlc3VsdCk7XG5cbiAgICBpZiAoIXJlc3VsdC5pZCkge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIFRlZC5wcm90b3R5cGUuY3JlYXRlTG9uZ1VybCA9IGZ1bmN0aW9uICh2aSwgcGFyYW1zKSB7XG4gICAgdmFyIHVybCA9ICcnO1xuXG4gICAgaWYgKHZpLm1lZGlhVHlwZSA9PT0gdGhpcy5tZWRpYVR5cGVzLlZJREVPICYmIHZpLmlkKSB7XG4gICAgICB1cmwgKz0gJ2h0dHBzOi8vdGVkLmNvbS90YWxrcy8nICsgdmkuaWQ7XG4gICAgfSBlbHNlIGlmICh2aS5tZWRpYVR5cGUgPT09IHRoaXMubWVkaWFUeXBlcy5QTEFZTElTVCAmJiB2aS5pZCkge1xuICAgICAgdXJsICs9ICdodHRwczovL3RlZC5jb20vcGxheWxpc3RzLycgKyB2aS5saXN0ICsgJy8nICsgdmkuaWQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgdXJsICs9IGNvbWJpbmVQYXJhbXMkZChwYXJhbXMpO1xuICAgIHJldHVybiB1cmw7XG4gIH07XG5cbiAgVGVkLnByb3RvdHlwZS5jcmVhdGVFbWJlZFVybCA9IGZ1bmN0aW9uICh2aSwgcGFyYW1zKSB7XG4gICAgdmFyIHVybCA9ICdodHRwczovL2VtYmVkLnRlZC5jb20vJztcblxuICAgIGlmICh2aS5tZWRpYVR5cGUgPT09IHRoaXMubWVkaWFUeXBlcy5QTEFZTElTVCAmJiB2aS5pZCkge1xuICAgICAgdXJsICs9ICdwbGF5bGlzdHMvJyArIHZpLmxpc3QgKyAnLycgKyB2aS5pZDtcbiAgICB9IGVsc2UgaWYgKHZpLm1lZGlhVHlwZSA9PT0gdGhpcy5tZWRpYVR5cGVzLlZJREVPICYmIHZpLmlkKSB7XG4gICAgICB1cmwgKz0gJ3RhbGtzLycgKyB2aS5pZDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICB1cmwgKz0gY29tYmluZVBhcmFtcyRkKHBhcmFtcyk7XG4gICAgcmV0dXJuIHVybDtcbiAgfTtcblxuICBiYXNlLmJpbmQobmV3IFRlZCgpKTtcblxuICB2YXIgY29tYmluZVBhcmFtcyRlID0gdXRpbC5jb21iaW5lUGFyYW1zO1xuXG4gIGZ1bmN0aW9uIEZhY2Vib29rKCkge1xuICAgIHRoaXMucHJvdmlkZXIgPSAnZmFjZWJvb2snO1xuICAgIHRoaXMuYWx0ZXJuYXRpdmVzID0gW107XG4gICAgdGhpcy5kZWZhdWx0Rm9ybWF0ID0gJ2xvbmcnO1xuICAgIHRoaXMuZm9ybWF0cyA9IHtcbiAgICAgIFwibG9uZ1wiOiB0aGlzLmNyZWF0ZUxvbmdVcmwsXG4gICAgICB3YXRjaDogdGhpcy5jcmVhdGVXYXRjaFVybFxuICAgIH07XG4gICAgdGhpcy5tZWRpYVR5cGVzID0ge1xuICAgICAgVklERU86ICd2aWRlbydcbiAgICB9O1xuICB9XG5cbiAgRmFjZWJvb2sucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24gKHVybCwgcGFyYW1zKSB7XG4gICAgdmFyIHJlc3VsdCA9IHtcbiAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgbWVkaWFUeXBlOiB0aGlzLm1lZGlhVHlwZXMuVklERU9cbiAgICB9O1xuICAgIHZhciBtYXRjaCA9IHVybC5tYXRjaCgvKD86XFwvKFxcZCspKT9cXC92aWRlb3MoPzpcXC8uKj8pP1xcLyhcXGQrKS9pKTtcblxuICAgIGlmIChtYXRjaCkge1xuICAgICAgaWYgKG1hdGNoWzFdKSB7XG4gICAgICAgIHJlc3VsdC5wYWdlSWQgPSBtYXRjaFsxXTtcbiAgICAgIH1cblxuICAgICAgcmVzdWx0LmlkID0gbWF0Y2hbMl07XG4gICAgfVxuXG4gICAgaWYgKHBhcmFtcy52ICYmICFyZXN1bHQuaWQpIHtcbiAgICAgIHJlc3VsdC5pZCA9IHBhcmFtcy52O1xuICAgICAgZGVsZXRlIHBhcmFtcy52O1xuICAgICAgcmVzdWx0LnBhcmFtcyA9IHBhcmFtcztcbiAgICB9XG5cbiAgICBpZiAoIXJlc3VsdC5pZCkge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIEZhY2Vib29rLnByb3RvdHlwZS5jcmVhdGVXYXRjaFVybCA9IGZ1bmN0aW9uICh2aSwgcGFyYW1zKSB7XG4gICAgdmFyIHVybCA9ICdodHRwczovL2ZhY2Vib29rLmNvbS93YXRjaC8nO1xuXG4gICAgaWYgKHZpLm1lZGlhVHlwZSAhPT0gdGhpcy5tZWRpYVR5cGVzLlZJREVPIHx8ICF2aS5pZCkge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICBwYXJhbXMgPSB7XG4gICAgICB2OiB2aS5pZFxuICAgIH07XG4gICAgdXJsICs9IGNvbWJpbmVQYXJhbXMkZShwYXJhbXMpO1xuICAgIHJldHVybiB1cmw7XG4gIH07XG5cbiAgRmFjZWJvb2sucHJvdG90eXBlLmNyZWF0ZUxvbmdVcmwgPSBmdW5jdGlvbiAodmksIHBhcmFtcykge1xuICAgIHZhciB1cmwgPSAnaHR0cHM6Ly9mYWNlYm9vay5jb20vJztcblxuICAgIGlmICh2aS5wYWdlSWQpIHtcbiAgICAgIHVybCArPSB2aS5wYWdlSWQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgaWYgKHZpLm1lZGlhVHlwZSA9PT0gdGhpcy5tZWRpYVR5cGVzLlZJREVPICYmIHZpLmlkKSB7XG4gICAgICB1cmwgKz0gJy92aWRlb3MvJyArIHZpLmlkO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHVybCArPSBjb21iaW5lUGFyYW1zJGUocGFyYW1zKTtcbiAgICByZXR1cm4gdXJsO1xuICB9O1xuXG4gIGJhc2UuYmluZChuZXcgRmFjZWJvb2soKSk7XG5cbiAgdmFyIGxpYiA9IGJhc2U7XG5cbiAgcmV0dXJuIGxpYjtcblxufSkpKTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///../../../../node_modules/js-video-url-parser/dist/jsVideoUrlParser.js\n");

/***/ })

}]);