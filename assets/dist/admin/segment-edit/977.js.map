{"version":3,"file":"977-ea503216fcfeb0150165.js","mappings":"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","sources":["webpack://./vue/entries/admin/segment-edit.ts/./vue/services/stack.ts","webpack://./vue/entries/admin/segment-edit.ts/./vue/components/segment-edit/section/SectionHomeworkEdit.vue?0efc","webpack://./vue/entries/admin/segment-edit.ts/./vue/components/segment-edit/section/SectionHomeworkEdit.vue","webpack://./vue/entries/admin/segment-edit.ts/./vue/services/form/tinymce/tinymce-option.ts"],"sourcesContent":["/**\n * Part of melo project.\n *\n * @copyright  Copyright (C) 2024 __ORGANIZATION__.\n * @license    __LICENSE__\n */\nexport default class Stack {\n    /**\n     * @type Stack[]\n     */\n    static stacks = {};\n    name = '';\n    store = [];\n    observers = [];\n    static create(name, store = []) {\n        if (name == null) {\n            throw new Error('Please provide a name.');\n        }\n        return new this(name, store);\n    }\n    static get(name, store = []) {\n        if (name == null) {\n            throw new Error('Please provide a name.');\n        }\n        if (!this.stacks[name]) {\n            this.stacks[name] = new Stack(name, store);\n        }\n        return this.stacks[name];\n    }\n    static set(name, stack) {\n        if (name == null) {\n            throw new Error('Please provide a name.');\n        }\n        this.stacks[name] = stack;\n        return this;\n    }\n    static remove() {\n        delete this.stacks[name];\n        return this;\n    }\n    static all() {\n        return this.stacks;\n    }\n    constructor(name, store = []) {\n        this.name = name;\n        this.store = store;\n    }\n    push(value = true) {\n        const r = this.store.push(value);\n        this.notice();\n        return r;\n    }\n    pop() {\n        const r = this.store.pop();\n        this.notice();\n        return r;\n    }\n    clear() {\n        this.store = [];\n        this.notice();\n        return this;\n    }\n    isEmpty() {\n        return this.store.length === 0;\n    }\n    get length() {\n        return this.store.length;\n    }\n    peek() {\n        return this.store;\n    }\n    observe(handler) {\n        this.observers.push({\n            handler\n        });\n        return this;\n    }\n    once(handler) {\n        this.observers.push({\n            handler,\n            once: true\n        });\n        return this;\n    }\n    notice() {\n        this.observers.forEach((observer) => {\n            observer.handler(this, this.length);\n        });\n        this.observers = this.observers.filter((observer) => observer.once !== true);\n        return this;\n    }\n    off(callback = null) {\n        this.observers = this.observers.filter((observer) => observer !== callback);\n        return this;\n    }\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nimport { ref, toRefs } from 'vue';\nimport { Segment } from '../../../types/segment.type';\nimport Editor from '@tinymce/tinymce-vue';\nimport { defaultOptions } from '../../../services/form/tinymce/tinymce-option';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'SectionHomeworkEdit',\n    props: {\n        item: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const { item } = toRefs(props);\n        const editorOptions = ref(defaultOptions());\n        return (_ctx, _cache) => {\n            const _component_BFormInput = _resolveComponent(\"BFormInput\");\n            const _component_BFormGroup = _resolveComponent(\"BFormGroup\");\n            return (_openBlock(), _createElementBlock(\"div\", null, [\n                _createVNode(_component_BFormGroup, {\n                    label: \"小節名稱編輯\",\n                    \"label-for\": \"input-section-title\",\n                    \"label-class\": \"mb-2\",\n                    class: \"mb-5\"\n                }, {\n                    default: _withCtx(() => [\n                        _createVNode(_component_BFormInput, {\n                            id: \"input-section-title\",\n                            modelValue: _unref(item).title,\n                            \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((_unref(item).title) = $event)),\n                            trim: \"\"\n                        }, null, 8, [\"modelValue\"])\n                    ]),\n                    _: 1\n                }),\n                _createVNode(_component_BFormGroup, {\n                    label: \"小節內容\",\n                    \"label-for\": \"input-section-content\",\n                    \"label-class\": \"mb-2\"\n                }, {\n                    default: _withCtx(() => [\n                        _createVNode(_unref(Editor), {\n                            modelValue: _unref(item).content,\n                            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event) => ((_unref(item).content) = $event)),\n                            \"api-key\": \"23aw7u2wc0a3ufumrfftdrrv3s8mox12kdnzr6juw1togrip\",\n                            style: { \"min-height\": \"216px\" },\n                            init: editorOptions.value\n                        }, null, 8, [\"modelValue\", \"init\"])\n                    ]),\n                    _: 1\n                })\n            ]));\n        };\n    }\n});\n","import script from \"./SectionHomeworkEdit.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SectionHomeworkEdit.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","/**\n * Part of melo project.\n *\n * @copyright  Copyright (C) 2024 __ORGANIZATION__.\n * @license    __LICENSE__\n */\nimport Stack from '../../stack';\nimport { merge } from 'lodash-es';\nexport function defaultOptions(override = () => { }) {\n    const lang = u.data('locale.short') || 'zh_TW';\n    const options = {\n        document_base_url: u.uri('root'),\n        plugins: [\n            'advlist', 'autolink', 'lists', 'link', 'image', 'charmap',\n            'preview', 'anchor', 'pagebreak', 'searchreplace', 'wordcount',\n            'visualblocks', 'visualchars', 'code', 'fullscreen', 'insertdatetime',\n            'media', 'nonbreaking', 'save', 'table', 'directionality',\n            'emoticons',\n        ],\n        toolbar: 'undo redo ' +\n            'bold italic strikethrough forecolor backcolor blockquote removeformat | ' +\n            'alignleft aligncenter alignright alignjustify bullist numlist outdent indent | ' +\n            'blocks fontsize styles styleselect formatselect fontsizeselect | ' +\n            'link image media table code | fullscreen',\n        language: lang === 'en_GB' ? null : lang,\n        language_url: u.uri('asset').root + 'vendor/tinymce-i18n/langs5/zh_TW.js',\n        font_size_formats: \"13px 14px 15px 16px 18px 20px 22px 28px 36px 48px\",\n        menubar: false,\n        remove_script_host: true,\n        relative_urls: true,\n        convert_urls: true,\n        forced_root_block: 'div',\n        toolbar_mode: 'sliding',\n        entity_encoding: 'raw',\n        table_header_type: 'sectionCells',\n        paste_data_images: true,\n        images_upload_url: u.route('file_upload'),\n        images_upload_handler: tinyMceImageUploader(),\n        height: 450,\n        content_css: u.uri('asset').root + 'css/front/editor.css',\n    };\n    if (typeof override === 'object') {\n        const custom = override;\n        override = (options) => merge(options, custom);\n    }\n    override(options);\n    return options;\n}\nexport function tinyMceImageUploader() {\n    return function (blobInfo, progress) {\n        return new Promise((resolve, reject) => {\n            u.data('no.save', true);\n            Stack.get('uploading').push();\n            const xhr = new XMLHttpRequest;\n            xhr.withCredentials = false;\n            xhr.open('POST', u.route('file_upload'));\n            xhr.upload.onprogress = (e) => {\n                progress(e.loaded / e.total * 100);\n            };\n            xhr.onload = function () {\n                Stack.get('uploading').pop();\n                if (xhr.status !== 200) {\n                    reject('HTTP Error: ' + decodeURIComponent(xhr.statusText));\n                    return;\n                }\n                const json = JSON.parse(xhr.responseText);\n                if (!json || typeof json.data.url !== 'string') {\n                    reject('Invalid JSON: ' + xhr.responseText);\n                    console.error('Invalid JSON: ' + xhr.responseText);\n                    u.data('no.save', false);\n                    return;\n                }\n                // Let's preload it first\n                const img = new Image();\n                img.src = json.data.url;\n                resolve(json.data.url);\n                u.data('no.save', false);\n            };\n            const formData = new FormData();\n            formData.append('file', blobInfo.blob(), blobInfo.filename());\n            formData.append(u.data('csrf-token'), '1');\n            xhr.send(formData);\n        });\n    };\n}\n"],"names":["Stack","static","name","store","observers","create","Error","this","get","stacks","set","stack","remove","all","constructor","push","value","r","notice","pop","clear","isEmpty","length","peek","observe","handler","once","forEach","observer","filter","off","callback","__name","props","item","setup","__props","toRefs","editorOptions","ref","override","lang","u","data","options","document_base_url","uri","plugins","toolbar","language","language_url","root","font_size_formats","menubar","remove_script_host","relative_urls","convert_urls","forced_root_block","toolbar_mode","entity_encoding","table_header_type","paste_data_images","images_upload_url","route","images_upload_handler","blobInfo","progress","Promise","resolve","reject","xhr","XMLHttpRequest","withCredentials","open","upload","onprogress","e","loaded","total","onload","status","decodeURIComponent","statusText","json","JSON","parse","responseText","url","console","error","Image","src","formData","FormData","append","blob","filename","send","height","content_css","custom","merge","defaultOptions","_ctx","_cache","_component_BFormInput","_component_BFormGroup","label","class","default","id","modelValue","title","$event","trim","_","content","style","init"],"sourceRoot":""}